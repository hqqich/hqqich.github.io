<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html"><meta property="og:site_name" content="blog"><meta property="og:title" content="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹"><meta property="og:description" content="å…¬ä¼—å·ï¼šå­—èŠ‚æ•°ç»„ (https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adbc507fc3704fd8955aae739a433db2~tplv-k3u1fbpfcp-zoom-1.image) å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ© ğŸ¤£ğŸ¤£ åœ¨ä»Šå¹´çš„ä¸‰æœˆä»½ï¼Œæˆ‘å› ä¸ºéœ€è¦ä¸ºé¡¹ç›®æ­å»ºä¸€ä¸ªæ–°çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶å¼€å§‹æ¥è§¦ Kotlin ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-02-06T07:53:08.000Z"><meta property="article:author" content="hqqich"><meta property="article:modified_time" content="2024-02-06T07:53:08.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹","image":[""],"dateModified":"2024-02-06T07:53:08.000Z","author":[{"@type":"Person","name":"hqqich","url":"https://mister-hope.com"}]}</script><title>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹ | blog</title><meta name="description" content="å…¬ä¼—å·ï¼šå­—èŠ‚æ•°ç»„ (https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adbc507fc3704fd8955aae739a433db2~tplv-k3u1fbpfcp-zoom-1.image) å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ© ğŸ¤£ğŸ¤£ åœ¨ä»Šå¹´çš„ä¸‰æœˆä»½ï¼Œæˆ‘å› ä¸ºéœ€è¦ä¸ºé¡¹ç›®æ­å»ºä¸€ä¸ªæ–°çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶å¼€å§‹æ¥è§¦ Kotlin ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/blog/dist/assets/style-e1af0ae0.css" as="style"><link rel="stylesheet" href="/blog/dist/assets/style-e1af0ae0.css">
    <link rel="modulepreload" href="/blog/dist/assets/app-51229bef.js"><link rel="modulepreload" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹.html-d4d4fe84.js"><link rel="modulepreload" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹.html-3c90f19c.js"><link rel="modulepreload" href="/blog/dist/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/blog/dist/assets/index.html-e68a8aa2.js" as="script"><link rel="prefetch" href="/blog/dist/assets/slides.html-141feb08.js" as="script"><link rel="prefetch" href="/blog/dist/assets/resume.html-af74f6e4.js" as="script"><link rel="prefetch" href="/blog/dist/assets/day01.html-5cb6ea40.js" as="script"><link rel="prefetch" href="/blog/dist/assets/HTMLä¸­çš„å¸¸ç”¨çš„ç‰¹æ®Šå­—ç¬¦ä»¥åŠæ‰€æœ‰ç‰¹æ®Šå­—ç¬¦.html-2d432f72.js" as="script"><link rel="prefetch" href="/blog/dist/assets/javaä¸­C3P0ã€Druidã€HikariCP ã€DBCPè¿æ¥æ± çš„jaråŒ…ä¸‹è½½ä¸IDEAé…ç½®.html-d2932e22.js" as="script"><link rel="prefetch" href="/blog/dist/assets/JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰ æ•´ç†ï¼ˆä¸€ï¼‰.html-c802af0e.js" as="script"><link rel="prefetch" href="/blog/dist/assets/MySQLå®æˆ˜45è®²ç¬”è®°.html-ec2ab87d.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-8542c835.js" as="script"><link rel="prefetch" href="/blog/dist/assets/SpringBootç¬¬åä¸‰ç¯‡ï¼šåŒæ—¶é›†æˆåä¸ºRC6.5.1å®‰å…¨ç‰ˆkafkaå’ŒåŸç”Ÿkafkaï¼Œé€šè¿‡é…ç½®æ–‡ä»¶åŠ¨æ€æ§åˆ¶.html-ac22ae42.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ã€SpringBootã€‘38 ä¸ªå¸¸ç”¨æ³¨è§£.html-d7c57776.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€å¥è¯æ€»ç»“Dockerä¸K8Sçš„å…³ç³».html-6a7f6a6a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Gson å’Œ Kotlin Data Class çš„é¿å‘æŒ‡å—.html-a623139a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ1ï¼‰.html-961f5401.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ2ï¼‰.html-99094553.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ3ï¼‰.html-7be13e9b.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹.html-aa909cef.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ2ï¼‰æ€ä¹ˆå®ç°å¤šçº¿ç¨‹åŒæ­¥.html-09735fe0.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ3ï¼‰çº¿ç¨‹æ´»æ€§æ•…éšœæœ‰å“ªäº›.html-0c5f434b.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ4ï¼‰é”çš„åˆ†ç±»æœ‰è¿™ä¹ˆå¤š.html-902cd12a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ5ï¼‰è¶…è¯¦ç»†çš„ ThreadPoolExecutor æºç è§£æ.html-70f6a38d.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ1ï¼‰åç¨‹åŸºç¡€.html-77631651.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ2ï¼‰å–æ¶ˆå’Œè¶…æ—¶.html-19d8a139.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ3ï¼‰ç»„åˆæŒ‚èµ·å‡½æ•°.html-ddc6b6d6.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ4ï¼‰åç¨‹ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨.html-c1cf30eb.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ5ï¼‰å¼‚æ­¥æµ.html-6bd6a909.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ6ï¼‰é€šé“.html-7f3d9497.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ7ï¼‰å¼‚å¸¸å¤„ç†.html-7cf96746.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ8ï¼‰å…±äº«å¯å˜çŠ¶æ€å’Œå¹¶å‘æ€§.html-7bbd762c.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ9ï¼‰é€‰æ‹©è¡¨è¾¾å¼.html-141431e0.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ ConstraintLayout.html-d30d5e5d.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson.html-fa42d3b0.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2.html-1e149b37.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡è¯»æ‡‚ Handler æœºåˆ¶.html-fbd99eda.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡è¯»æ‡‚ Java å’Œ Kotlin çš„æ³›å‹éš¾ç‚¹.html-18d81276.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸¤ä¸‡å…­åƒå­—å¸¦ä½  Kotlin å…¥é—¨.html-e498c185.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ11ï¼‰OkHttp æºç è¯¦è§£.html-21ddad98.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ12ï¼‰OkHttp _ Retrofit å¼€å‘è°ƒè¯•åˆ©å™¨.html-e767fb05.js" as="script"><link rel="prefetch" href="/blog/dist/assets/æ¢ç©¶ Bitmap çš„ä¼˜åŒ–æ‰‹æ®µ.html-c4921d11.js" as="script"><link rel="prefetch" href="/blog/dist/assets/æ¢ç©¶ Kotlin çš„éšè—æ€§èƒ½å¼€é”€ä¸é¿å‘æŒ‡å—.html-4af3fd33.js" as="script"><link rel="prefetch" href="/blog/dist/assets/404.html-3afd45f4.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-8daec251.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-8ecd507a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-e4e82f19.js" as="script"><link rel="prefetch" href="/blog/dist/assets/slides.html-92501863.js" as="script"><link rel="prefetch" href="/blog/dist/assets/resume.html-d3a3cb4e.js" as="script"><link rel="prefetch" href="/blog/dist/assets/day01.html-21ded407.js" as="script"><link rel="prefetch" href="/blog/dist/assets/HTMLä¸­çš„å¸¸ç”¨çš„ç‰¹æ®Šå­—ç¬¦ä»¥åŠæ‰€æœ‰ç‰¹æ®Šå­—ç¬¦.html-31a1c09a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/javaä¸­C3P0ã€Druidã€HikariCP ã€DBCPè¿æ¥æ± çš„jaråŒ…ä¸‹è½½ä¸IDEAé…ç½®.html-759bae86.js" as="script"><link rel="prefetch" href="/blog/dist/assets/JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰ æ•´ç†ï¼ˆä¸€ï¼‰.html-b7a3a911.js" as="script"><link rel="prefetch" href="/blog/dist/assets/MySQLå®æˆ˜45è®²ç¬”è®°.html-4a0b591a.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-64791cb6.js" as="script"><link rel="prefetch" href="/blog/dist/assets/SpringBootç¬¬åä¸‰ç¯‡ï¼šåŒæ—¶é›†æˆåä¸ºRC6.5.1å®‰å…¨ç‰ˆkafkaå’ŒåŸç”Ÿkafkaï¼Œé€šè¿‡é…ç½®æ–‡ä»¶åŠ¨æ€æ§åˆ¶.html-552992bb.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ã€SpringBootã€‘38 ä¸ªå¸¸ç”¨æ³¨è§£.html-d8f2815c.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€å¥è¯æ€»ç»“Dockerä¸K8Sçš„å…³ç³».html-c9e13d20.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Gson å’Œ Kotlin Data Class çš„é¿å‘æŒ‡å—.html-060a06ab.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ1ï¼‰.html-1346c78c.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ2ï¼‰.html-bdab798c.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java _ Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ3ï¼‰.html-6c742382.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹.html-4863c0c3.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ2ï¼‰æ€ä¹ˆå®ç°å¤šçº¿ç¨‹åŒæ­¥.html-c3739d19.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ3ï¼‰çº¿ç¨‹æ´»æ€§æ•…éšœæœ‰å“ªäº›.html-fa61e24d.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ4ï¼‰é”çš„åˆ†ç±»æœ‰è¿™ä¹ˆå¤š.html-44c86f41.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ5ï¼‰è¶…è¯¦ç»†çš„ ThreadPoolExecutor æºç è§£æ.html-311bd7fe.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ1ï¼‰åç¨‹åŸºç¡€.html-fddec7be.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ2ï¼‰å–æ¶ˆå’Œè¶…æ—¶.html-48773ebe.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ3ï¼‰ç»„åˆæŒ‚èµ·å‡½æ•°.html-b671ddb2.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ4ï¼‰åç¨‹ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨.html-c5b0997b.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ5ï¼‰å¼‚æ­¥æµ.html-15a39b74.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ6ï¼‰é€šé“.html-e1d05728.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ7ï¼‰å¼‚å¸¸å¤„ç†.html-660ca6f1.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ8ï¼‰å…±äº«å¯å˜çŠ¶æ€å’Œå¹¶å‘æ€§.html-6de5c111.js" as="script"><link rel="prefetch" href="/blog/dist/assets/Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ9ï¼‰é€‰æ‹©è¡¨è¾¾å¼.html-8ad2d377.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ ConstraintLayout.html-45a4c940.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson.html-367aad03.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2.html-9d0730ce.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡è¯»æ‡‚ Handler æœºåˆ¶.html-3f713715.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸€æ–‡è¯»æ‡‚ Java å’Œ Kotlin çš„æ³›å‹éš¾ç‚¹.html-3319b95f.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸¤ä¸‡å…­åƒå­—å¸¦ä½  Kotlin å…¥é—¨.html-e4ff77b7.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ11ï¼‰OkHttp æºç è¯¦è§£.html-d13bfb62.js" as="script"><link rel="prefetch" href="/blog/dist/assets/ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ12ï¼‰OkHttp _ Retrofit å¼€å‘è°ƒè¯•åˆ©å™¨.html-89cdf954.js" as="script"><link rel="prefetch" href="/blog/dist/assets/æ¢ç©¶ Bitmap çš„ä¼˜åŒ–æ‰‹æ®µ.html-9ccfb357.js" as="script"><link rel="prefetch" href="/blog/dist/assets/æ¢ç©¶ Kotlin çš„éšè—æ€§èƒ½å¼€é”€ä¸é¿å‘æŒ‡å—.html-de7de8ba.js" as="script"><link rel="prefetch" href="/blog/dist/assets/404.html-278097a8.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-87e883c0.js" as="script"><link rel="prefetch" href="/blog/dist/assets/index.html-33b540b9.js" as="script"><link rel="prefetch" href="/blog/dist/assets/photoswipe.esm-060dc2da.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/blog/dist/"><img class="vp-nav-logo" src="/blog/dist/logo.svg" alt="blog"><!----><span class="vp-site-name hide-in-pad">blog</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä¸»é¡µ" class="vp-link nav-link nav-link" href="/blog/dist/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="about me" class="vp-link nav-link nav-link" href="/blog/dist/md/resume.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>about me<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="å­¦ä¹ æ—¥å¿—" class="vp-link nav-link nav-link" href="/blog/dist/md/dev-log/day01.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>å­¦ä¹ æ—¥å¿—<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="kotlin" class="vp-link nav-link nav-link" href="/blog/dist/md/kotlin/%E4%B8%A4%E4%B8%87%E5%85%AD%E5%8D%83%E5%AD%97%E5%B8%A6%E4%BD%A0%20Kotlin%20%E5%85%A5%E9%97%A8.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>kotlin<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/hqqich/hqqich.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="ä¸»é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><span class="vp-sidebar-title">å­¦ä¹ æ—¥å¿—</span><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Day01" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/day01.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Day01<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="MySQLå®æˆ˜45è®²ç¬”è®°" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2%E7%AC%94%E8%AE%B0.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>MySQLå®æˆ˜45è®²ç¬”è®°<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="SpringBootç¬¬åä¸‰ç¯‡ï¼šåŒæ—¶é›†æˆåä¸ºRC6.5.1å®‰å…¨ç‰ˆkafkaå’ŒåŸç”Ÿkafkaï¼Œé€šè¿‡é…ç½®æ–‡ä»¶åŠ¨æ€æ§åˆ¶" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/SpringBoot%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AF%87%EF%BC%9A%E5%90%8C%E6%97%B6%E9%9B%86%E6%88%90%E5%8D%8E%E4%B8%BARC6.5.1%E5%AE%89%E5%85%A8%E7%89%88kafka%E5%92%8C%E5%8E%9F%E7%94%9Fkafka%EF%BC%8C%E9%80%9A%E8%BF%87%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A8%E6%80%81%E6%8E%A7%E5%88%B6.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringBootç¬¬åä¸‰ç¯‡ï¼šåŒæ—¶é›†æˆåä¸ºRC6.5.1å®‰å…¨ç‰ˆkafkaå’ŒåŸç”Ÿkafkaï¼Œé€šè¿‡é…ç½®æ–‡ä»¶åŠ¨æ€æ§åˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="/md/dev-log/ã€SpringBootã€‘ SpringBootæ ¸å¿ƒ-CSDNåšå®¢.md" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/ã€SpringBootã€‘ SpringBootæ ¸å¿ƒ-CSDNåšå®¢.html"><!---->/md/dev-log/ã€SpringBootã€‘ SpringBootæ ¸å¿ƒ-CSDNåšå®¢.md<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€å¥è¯æ€»ç»“Dockerä¸K8Sçš„å…³ç³»" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%80%BB%E7%BB%93Docker%E4%B8%8EK8S%E7%9A%84%E5%85%B3%E7%B3%BB.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€å¥è¯æ€»ç»“Dockerä¸K8Sçš„å…³ç³»<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰ æ•´ç†ï¼ˆä¸€ï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/JVM%EF%BC%88Java%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%89%20%E6%95%B4%E7%90%86%EF%BC%88%E4%B8%80%EF%BC%89.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰ æ•´ç†ï¼ˆä¸€ï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ã€SpringBootã€‘38 ä¸ªå¸¸ç”¨æ³¨è§£" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/%E3%80%90SpringBoot%E3%80%9138%20%E4%B8%AA%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ã€SpringBootã€‘38 ä¸ªå¸¸ç”¨æ³¨è§£<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="HTMLä¸­çš„å¸¸ç”¨çš„ç‰¹æ®Šå­—ç¬¦ä»¥åŠæ‰€æœ‰ç‰¹æ®Šå­—ç¬¦" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/HTML%E4%B8%AD%E7%9A%84%E5%B8%B8%E7%94%A8%E7%9A%84%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E4%BB%A5%E5%8F%8A%E6%89%80%E6%9C%89%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>HTMLä¸­çš„å¸¸ç”¨çš„ç‰¹æ®Šå­—ç¬¦ä»¥åŠæ‰€æœ‰ç‰¹æ®Šå­—ç¬¦<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="javaä¸­C3P0ã€Druidã€HikariCP ã€DBCPè¿æ¥æ± çš„jaråŒ…ä¸‹è½½ä¸IDEAé…ç½®" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/dev-log/java%E4%B8%ADC3P0%E3%80%81Druid%E3%80%81HikariCP%20%E3%80%81DBCP%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84jar%E5%8C%85%E4%B8%8B%E8%BD%BD%E4%B8%8EIDEA%E9%85%8D%E7%BD%AE.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>javaä¸­C3P0ã€Druidã€HikariCP ã€DBCPè¿æ¥æ± çš„jaråŒ…ä¸‹è½½ä¸IDEAé…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading active"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><span class="vp-sidebar-title">kotlin</span><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Gson å’Œ Kotlin Data Class çš„é¿å‘æŒ‡å—" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Gson%20%E5%92%8C%20Kotlin%20Data%20Class%20%E7%9A%84%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Gson å’Œ Kotlin Data Class çš„é¿å‘æŒ‡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ1ï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20_%20Android%20%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E9%A1%BB%E7%9F%A5%E9%A1%BB%E4%BC%9A%EF%BC%881%EF%BC%89.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ1ï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ2ï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20_%20Android%20%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E9%A1%BB%E7%9F%A5%E9%A1%BB%E4%BC%9A%EF%BC%882%EF%BC%89.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ2ï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ3ï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20_%20Android%20%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E9%A1%BB%E7%9F%A5%E9%A1%BB%E4%BC%9A%EF%BC%883%EF%BC%89.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java &amp; Android é›†åˆæ¡†æ¶é¡»çŸ¥é¡»ä¼šï¼ˆ3ï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ2ï¼‰æ€ä¹ˆå®ç°å¤šçº¿ç¨‹åŒæ­¥" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91%EF%BC%882%EF%BC%89%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ2ï¼‰æ€ä¹ˆå®ç°å¤šçº¿ç¨‹åŒæ­¥<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ3ï¼‰çº¿ç¨‹æ´»æ€§æ•…éšœæœ‰å“ªäº›" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91%EF%BC%883%EF%BC%89%E7%BA%BF%E7%A8%8B%E6%B4%BB%E6%80%A7%E6%95%85%E9%9A%9C%E6%9C%89%E5%93%AA%E4%BA%9B.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ3ï¼‰çº¿ç¨‹æ´»æ€§æ•…éšœæœ‰å“ªäº›<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ4ï¼‰é”çš„åˆ†ç±»æœ‰è¿™ä¹ˆå¤š" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91%EF%BC%884%EF%BC%89%E9%94%81%E7%9A%84%E5%88%86%E7%B1%BB%E6%9C%89%E8%BF%99%E4%B9%88%E5%A4%9A.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ4ï¼‰é”çš„åˆ†ç±»æœ‰è¿™ä¹ˆå¤š<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ5ï¼‰è¶…è¯¦ç»†çš„ ThreadPoolExecutor æºç è§£æ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91%EF%BC%885%EF%BC%89%E8%B6%85%E8%AF%A6%E7%BB%86%E7%9A%84%20ThreadPoolExecutor%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Java å¤šçº¿ç¨‹å¼€å‘ï¼ˆ5ï¼‰è¶…è¯¦ç»†çš„ ThreadPoolExecutor æºç è§£æ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ1ï¼‰åç¨‹åŸºç¡€" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%881%EF%BC%89%E5%8D%8F%E7%A8%8B%E5%9F%BA%E7%A1%80.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ1ï¼‰åç¨‹åŸºç¡€<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ2ï¼‰å–æ¶ˆå’Œè¶…æ—¶" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%882%EF%BC%89%E5%8F%96%E6%B6%88%E5%92%8C%E8%B6%85%E6%97%B6.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ2ï¼‰å–æ¶ˆå’Œè¶…æ—¶<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ3ï¼‰ç»„åˆæŒ‚èµ·å‡½æ•°" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%883%EF%BC%89%E7%BB%84%E5%90%88%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ3ï¼‰ç»„åˆæŒ‚èµ·å‡½æ•°<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ4ï¼‰åç¨‹ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%884%EF%BC%89%E5%8D%8F%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%92%8C%E8%B0%83%E5%BA%A6%E5%99%A8.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ4ï¼‰åç¨‹ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ5ï¼‰å¼‚æ­¥æµ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%885%EF%BC%89%E5%BC%82%E6%AD%A5%E6%B5%81.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ5ï¼‰å¼‚æ­¥æµ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ6ï¼‰é€šé“" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%886%EF%BC%89%E9%80%9A%E9%81%93.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ6ï¼‰é€šé“<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ7ï¼‰å¼‚å¸¸å¤„ç†" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%887%EF%BC%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ7ï¼‰å¼‚å¸¸å¤„ç†<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ8ï¼‰å…±äº«å¯å˜çŠ¶æ€å’Œå¹¶å‘æ€§" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%888%EF%BC%89%E5%85%B1%E4%BA%AB%E5%8F%AF%E5%8F%98%E7%8A%B6%E6%80%81%E5%92%8C%E5%B9%B6%E5%8F%91%E6%80%A7.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ8ï¼‰å…±äº«å¯å˜çŠ¶æ€å’Œå¹¶å‘æ€§<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ9ï¼‰é€‰æ‹©è¡¨è¾¾å¼" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/Kotlin%20%E5%8D%8F%E7%A8%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%889%EF%BC%89%E9%80%89%E6%8B%A9%E8%A1%A8%E8%BE%BE%E5%BC%8F.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ9ï¼‰é€‰æ‹©è¡¨è¾¾å¼<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ ConstraintLayout" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20ConstraintLayout.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ ConstraintLayout<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Gson.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1ã€GlobalScope" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€globalscope"><!---->1ã€GlobalScope<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€runBlocking" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€runblocking"><!---->2ã€runBlocking<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3ã€coroutineScope" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_3ã€coroutinescope"><!---->3ã€coroutineScope<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4ã€supervisorScope" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_4ã€supervisorscope"><!---->4ã€supervisorScope<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5ã€è‡ªå®šä¹‰ CoroutineScope" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_5ã€è‡ªå®šä¹‰-coroutinescope"><!---->5ã€è‡ªå®šä¹‰ CoroutineScope<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1ã€launch" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€launch"><!---->1ã€launch<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€Job" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€job"><!---->2ã€Job<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3ã€async" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_3ã€async"><!---->3ã€async<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4ã€async é”™è¯¯ç”¨æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_4ã€async-é”™è¯¯ç”¨æ³•"><!---->4ã€async é”™è¯¯ç”¨æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5ã€async å¹¶è¡Œåˆ†è§£" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_5ã€async-å¹¶è¡Œåˆ†è§£"><!---->5ã€async å¹¶è¡Œåˆ†è§£<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6ã€Deferred" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_6ã€deferred"><!---->6ã€Deferred<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1ã€Job" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€job"><!---->1ã€Job<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€CoroutineDispatcher" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€coroutinedispatcher"><!---->2ã€CoroutineDispatcher<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3ã€withContext" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_3ã€withcontext"><!---->3ã€withContext<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4ã€CoroutineName" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_4ã€coroutinename"><!---->4ã€CoroutineName<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5ã€CoroutineExceptionHandler" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_5ã€coroutineexceptionhandler"><!---->5ã€CoroutineExceptionHandler<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ " class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ "><!---->6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ <!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ"><!---->1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€ç”¨ finally é‡Šæ”¾èµ„æº" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€ç”¨-finally-é‡Šæ”¾èµ„æº"><!---->2ã€ç”¨ finally é‡Šæ”¾èµ„æº<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3ã€NonCancellable" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_3ã€noncancellable"><!---->3ã€NonCancellable<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4ã€çˆ¶åç¨‹å’Œå­åç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_4ã€çˆ¶åç¨‹å’Œå­åç¨‹"><!---->4ã€çˆ¶åç¨‹å’Œå­åç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ"><!---->5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6ã€withTimeout" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_6ã€withtimeout"><!---->6ã€withTimeout<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1ã€CoroutineExceptionHandler" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€coroutineexceptionhandler"><!---->1ã€CoroutineExceptionHandler<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€SupervisorJob" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€supervisorjob"><!---->2ã€SupervisorJob<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1ã€Lifecycle ktx" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_1ã€lifecycle-ktx"><!---->1ã€Lifecycle ktx<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2ã€ViewModel ktx" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_2ã€viewmodel-ktx"><!---->2ã€ViewModel ktx<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3ã€LiveData ktx" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Kotlin%20%E5%8D%8F%E7%A8%8B.html#_3ã€livedata-ktx"><!---->3ã€LiveData ktx<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20RxJava%202.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡è¯»æ‡‚ Handler æœºåˆ¶" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%20Handler%20%E6%9C%BA%E5%88%B6.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡è¯»æ‡‚ Handler æœºåˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸€æ–‡è¯»æ‡‚ Java å’Œ Kotlin çš„æ³›å‹éš¾ç‚¹" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%20Java%20%E5%92%8C%20Kotlin%20%E7%9A%84%E6%B3%9B%E5%9E%8B%E9%9A%BE%E7%82%B9.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡è¯»æ‡‚ Java å’Œ Kotlin çš„æ³›å‹éš¾ç‚¹<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸¤ä¸‡å…­åƒå­—å¸¦ä½  Kotlin å…¥é—¨" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%A4%E4%B8%87%E5%85%AD%E5%8D%83%E5%AD%97%E5%B8%A6%E4%BD%A0%20Kotlin%20%E5%85%A5%E9%97%A8.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸¤ä¸‡å…­åƒå­—å¸¦ä½  Kotlin å…¥é—¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ11ï¼‰OkHttp æºç è¯¦è§£" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%BB%E6%B5%81%E5%BC%80%E6%BA%90%E5%BA%93%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%8811%EF%BC%89OkHttp%20%E6%BA%90%E7%A0%81%E8%AF%A6%E8%A7%A3.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ11ï¼‰OkHttp æºç è¯¦è§£<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ12ï¼‰OkHttp &amp; Retrofit å¼€å‘è°ƒè¯•åˆ©å™¨" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E4%B8%BB%E6%B5%81%E5%BC%80%E6%BA%90%E5%BA%93%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%8812%EF%BC%89OkHttp%20_%20Retrofit%20%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E5%88%A9%E5%99%A8.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸»æµå¼€æºåº“æºç åˆ†æï¼ˆ12ï¼‰OkHttp &amp; Retrofit å¼€å‘è°ƒè¯•åˆ©å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="æ¢ç©¶ Bitmap çš„ä¼˜åŒ–æ‰‹æ®µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E6%8E%A2%E7%A9%B6%20Bitmap%20%E7%9A%84%E4%BC%98%E5%8C%96%E6%89%8B%E6%AE%B5.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>æ¢ç©¶ Bitmap çš„ä¼˜åŒ–æ‰‹æ®µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="æ¢ç©¶ Kotlin çš„éšè—æ€§èƒ½å¼€é”€ä¸é¿å‘æŒ‡å—" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/blog/dist/md/kotlin/%E6%8E%A2%E7%A9%B6%20Kotlin%20%E7%9A%84%E9%9A%90%E8%97%8F%E6%80%A7%E8%83%BD%E5%BC%80%E9%94%80%E4%B8%8E%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>æ¢ç©¶ Kotlin çš„éšè—æ€§èƒ½å¼€é”€ä¸é¿å‘æŒ‡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">hqqich</a></span><span property="author" content="hqqich"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-02-06T07:53:08.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 39 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT39M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category1" role>kotlin</span><!--]--><meta property="articleSection" content="kotlin"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€globalscope">1ã€GlobalScope</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€runblocking">2ã€runBlocking</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_3ã€coroutinescope">3ã€coroutineScope</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_4ã€supervisorscope">4ã€supervisorScope</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_5ã€è‡ªå®šä¹‰-coroutinescope">5ã€è‡ªå®šä¹‰ CoroutineScope</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€launch">1ã€launch</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€job">2ã€Job</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_3ã€async">3ã€async</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_4ã€async-é”™è¯¯ç”¨æ³•">4ã€async é”™è¯¯ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_5ã€async-å¹¶è¡Œåˆ†è§£">5ã€async å¹¶è¡Œåˆ†è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_6ã€deferred">6ã€Deferred</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€job">1ã€Job</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€coroutinedispatcher">2ã€CoroutineDispatcher</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_3ã€withcontext">3ã€withContext</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_4ã€coroutinename">4ã€CoroutineName</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_5ã€coroutineexceptionhandler">5ã€CoroutineExceptionHandler</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ ">6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ </a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ">1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€ç”¨-finally-é‡Šæ”¾èµ„æº">2ã€ç”¨ finally é‡Šæ”¾èµ„æº</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_3ã€noncancellable">3ã€NonCancellable</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_4ã€çˆ¶åç¨‹å’Œå­åç¨‹">4ã€çˆ¶åç¨‹å’Œå­åç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ">5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_6ã€withtimeout">6ã€withTimeout</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€coroutineexceptionhandler">1ã€CoroutineExceptionHandler</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€supervisorjob">2ã€SupervisorJob</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_1ã€lifecycle-ktx">1ã€Lifecycle ktx</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_2ã€viewmodel-ktx">2ã€ViewModel ktx</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/dist/#_3ã€livedata-ktx">3ã€LiveData ktx</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><blockquote><p>å…¬ä¼—å·ï¼š<a href="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adbc507fc3704fd8955aae739a433db2~tplv-k3u1fbpfcp-zoom-1.image" target="_blank" rel="noopener noreferrer">å­—èŠ‚æ•°ç»„<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ© ğŸ¤£ğŸ¤£</p></blockquote><p>åœ¨ä»Šå¹´çš„ä¸‰æœˆä»½ï¼Œæˆ‘å› ä¸ºéœ€è¦ä¸ºé¡¹ç›®æ­å»ºä¸€ä¸ªæ–°çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶å¼€å§‹æ¥è§¦ Kotlin åç¨‹ã€‚é‚£æ—¶æˆ‘å¸é¡¹ç›®ä¸­åŒæ—¶å­˜åœ¨ç€ä¸¤ç§ç½‘ç»œè¯·æ±‚æ–¹å¼ï¼Œé‡‡ç”¨çš„æŠ€æœ¯æ ˆå„ä¸ç›¸åŒï¼ŒJavaã€Kotlinã€RxJavaã€LiveData å„ç§æ··æ­ï¼ŒæŠ€æœ¯æ ˆçš„ä¸ç»Ÿä¸€é•¿è¿œæ¥çœ‹è‚¯å®šæ˜¯ä¼šé€ æˆå¾ˆå¤šä¸ä¾¿çš„ï¼Œæ‰€ä»¥å°±æ‰“ç®—å°è£…ä¸€ä¸ªæ–°çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶æ¥ä½œä¸ºé¡¹ç›®çš„ç»Ÿä¸€è§„èŒƒï¼ˆå‰é¢çš„äººä¼°è®¡ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œæ‰€ä»¥å°±é€ æˆäº†åŒä¸ªé¡¹ç›®ä¸­çš„ç½‘ç»œè¯·æ±‚æ–¹å¼è¶Šæ¥è¶Šå¤š ğŸ˜‚ğŸ˜‚ï¼‰ï¼Œé‚£ä¹ˆå°±éœ€è¦è€ƒè™‘é‡‡ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆæ¥å®ç°äº†</p><p>é‡‡ç”¨ Kotlin è¯­è¨€æ¥å®ç°å¿…ä¸å¯å°‘ï¼Œéƒ½è¿™å¹´å¤´äº†è¿˜ç”¨ Java ä¹Ÿè¯´ä¸è¿‡å»ã€‚Retrofit ä¹Ÿå¿…ä¸å¯å°‘ï¼Œè€Œç›®å‰ Retrofit ä¹Ÿå·²ç»æ”¯æŒ Kotlin åç¨‹äº†ï¼ŒGoogle å®˜æ–¹æ¨å‡ºçš„ Jetpack åç¨‹æ‰©å±•åº“ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå°±æœ€ç»ˆå†³å®šå¼ƒç”¨ RxJava æ‹¥æŠ± Kotlin åç¨‹ï¼Œå°†åç¨‹ä½œä¸ºæŠ€æœ¯æ ˆä¹‹ä¸€</p><p>å½“æ—¶æˆ‘æ˜¯é€šè¿‡ç¿»è¯‘åç¨‹å®˜æ–¹æ–‡æ¡£æ¥ä½œä¸ºå…¥é—¨æ‰‹æ®µï¼Œåˆ°ç°åœ¨ä¹Ÿå¤§åŠå¹´äº†ï¼Œå›å¤´æ¥çœ‹æ„Ÿè§‰å®˜æ–¹æ–‡æ¡£è¿˜æ˜¯æŒºæ™¦æ¶©éš¾æ‡‚çš„ï¼Œå°±æƒ³ç€å†æ¥å†™ä¸€ä¸¤ç¯‡å…¥é—¨æˆ–è¿›é˜¶çš„æ–‡ç« æ¥åŠ æ·±ä¸‹ç†è§£ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©</p><p>é™„ä¸Šæˆ‘å½“æ—¶ç¿»è¯‘çš„åç¨‹å®˜æ–¹æ–‡æ¡£ï¼š</p><ul><li><a href="https://juejin.cn/post/6844903972755472391" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ1ï¼‰-åç¨‹åŸºç¡€ï¼ˆCoroutine Basicsï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904098899181582" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ2ï¼‰-å–æ¶ˆå’Œè¶…æ—¶ï¼ˆCancellation and Timeoutsï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904100102930445" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ3ï¼‰-ç»„åˆæŒ‚èµ·å‡½æ•°ï¼ˆCoroutine Context and Dispatchersï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904100103094280" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ4ï¼‰-åç¨‹ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨ï¼ˆCoroutine Context and Dispatchersï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904101801639949" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ5ï¼‰-å¼‚æ­¥æµï¼ˆAsynchronous Flowï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904102040698893" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ6ï¼‰-é€šé“ï¼ˆChannelsï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904103080886285" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ7ï¼‰-å¼‚å¸¸å¤„ç†ï¼ˆException Handlingï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904104053964808" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ8ï¼‰-å…±äº«å¯å˜çŠ¶æ€å’Œå¹¶å‘æ€§ï¼ˆShared mutable state and concurrencyï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://juejin.cn/post/6844904106788667400" target="_blank" rel="noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£ï¼ˆ9ï¼‰-é€‰æ‹©è¡¨è¾¾å¼(å®éªŒé˜¶æ®µ)ï¼ˆSelect Expression (experimental)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h1 id="ä¸€ã€kotlin-åç¨‹" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€kotlin-åç¨‹" aria-hidden="true">#</a> ä¸€ã€Kotlin åç¨‹</h1><p>Kotlin åç¨‹æä¾›äº†ä¸€ç§å…¨æ–°å¤„ç†å¹¶å‘çš„æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨ Android å¹³å°ä¸Šä½¿ç”¨å®ƒæ¥ç®€åŒ–å¼‚æ­¥æ‰§è¡Œçš„ä»£ç ã€‚åç¨‹ä» Kotlin 1.3 ç‰ˆæœ¬å¼€å§‹å¼•å…¥ï¼Œä½†è¿™ä¸€æ¦‚å¿µåœ¨ç¼–ç¨‹ä¸–ç•Œè¯ç”Ÿçš„é»æ˜ä¹‹é™…å°±æœ‰äº†ï¼Œæœ€æ—©ä½¿ç”¨åç¨‹çš„ç¼–ç¨‹è¯­è¨€å¯ä»¥è¿½æº¯åˆ° 1967 å¹´çš„ Simula è¯­è¨€ã€‚åœ¨è¿‡å»å‡ å¹´é—´ï¼Œåç¨‹è¿™ä¸ªæ¦‚å¿µå‘å±•åŠ¿å¤´è¿…çŒ›ï¼Œç°å·²ç»è¢«è¯¸å¤šä¸»æµç¼–ç¨‹è¯­è¨€é‡‡ç”¨ï¼Œæ¯”å¦‚ Javascriptã€C#ã€Pythonã€Ruby ä»¥åŠ Go ç­‰ã€‚Kotlin åç¨‹æ˜¯åŸºäºæ¥è‡ªå…¶ä»–è¯­è¨€çš„æ—¢å®šæ¦‚å¿µ</p><p>Google å®˜æ–¹æ¨èå°† Kotlin åç¨‹ä½œä¸ºåœ¨ Android ä¸Šè¿›è¡Œå¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼Œå€¼å¾—å…³æ³¨çš„åŠŸèƒ½ç‚¹åŒ…æ‹¬ï¼š</p><ul><li>è½»é‡ï¼šå¯ä»¥åœ¨å•ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œå¤šä¸ªåç¨‹ï¼Œå› ä¸ºåç¨‹æ”¯æŒæŒ‚èµ·ï¼Œä¸ä¼šä½¿æ­£åœ¨è¿è¡Œåç¨‹çš„çº¿ç¨‹é˜»å¡ã€‚æŒ‚èµ·æ¯”é˜»å¡èŠ‚çœå†…å­˜ï¼Œä¸”æ”¯æŒå¤šä¸ªå¹¶è¡Œæ“ä½œ</li><li>å†…å­˜æ³„éœ²æ›´å°‘ï¼šä½¿ç”¨ç»“æ„åŒ–å¹¶å‘æœºåˆ¶åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…æ‰§è¡Œå¤šä¸ªæ“ä½œ</li><li>å†…ç½®å–æ¶ˆæ”¯æŒï¼šå–æ¶ˆåŠŸèƒ½ä¼šè‡ªåŠ¨é€šè¿‡æ­£åœ¨è¿è¡Œçš„åç¨‹å±‚æ¬¡ç»“æ„ä¼ æ’­</li><li>Jetpack é›†æˆï¼šè®¸å¤š Jetpack åº“éƒ½åŒ…å«æä¾›å…¨é¢åç¨‹æ”¯æŒçš„æ‰©å±•ã€‚æŸäº›åº“è¿˜æä¾›è‡ªå·±çš„åç¨‹ä½œç”¨åŸŸï¼Œå¯ä¾›ä½ ç”¨äºç»“æ„åŒ–å¹¶å‘</li></ul><p>å¦‚æœæ˜¯ç”¨äº Android å¹³å°çš„è¯ï¼Œå¯ä»¥åªå¼•ç”¨ä»¥ä¸‹çš„ coroutines-androidï¼Œå½“ä¸­å·²ç»åŒ…å«äº† coroutines-core</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code>implementation &#39;org<span class="token punctuation">.</span>jetbrains<span class="token punctuation">.</span>kotlinx<span class="token operator">:</span>kotlinx<span class="token operator">-</span>coroutines<span class="token operator">-</span>core<span class="token operator">:</span><span class="token number">1.5</span><span class="token punctuation">.</span><span class="token number">2</span>&#39;
implementation &#39;org<span class="token punctuation">.</span>jetbrains<span class="token punctuation">.</span>kotlinx<span class="token operator">:</span>kotlinx<span class="token operator">-</span>coroutines<span class="token operator">-</span>android<span class="token operator">:</span><span class="token number">1.5</span><span class="token punctuation">.</span><span class="token number">2</span>&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="äºŒã€ç¬¬ä¸€ä¸ªåç¨‹" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç¬¬ä¸€ä¸ªåç¨‹" aria-hidden="true">#</a> äºŒã€ç¬¬ä¸€ä¸ªåç¨‹</h1><p>åç¨‹å¯ä»¥ç§°ä¸º <strong>è½»é‡çº§çº¿ç¨‹</strong>ã€‚Kotlin åç¨‹åœ¨ CoroutineScope çš„ä¸Šä¸‹æ–‡ä¸­é€šè¿‡ launchã€async ç­‰ <strong>åç¨‹æ„é€ å™¨</strong>ï¼ˆCoroutineBuilderï¼‰æ¥å£°æ˜å¹¶å¯åŠ¨</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>context <span class="token operator">=</span> Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å»¶æ—¶ä¸€ç§’</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launch&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ä¸»åŠ¨ä¼‘çœ ä¸¤ç§’ï¼Œé˜²æ­¢ JVM è¿‡å¿«é€€å‡º</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token operator">:</span> Any<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">msg</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> launch
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> end
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé€šè¿‡ GlobalScopeï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰å¯åŠ¨äº†ä¸€ä¸ªåç¨‹ï¼Œåœ¨å»¶è¿Ÿä¸€ç§’åè¾“å‡ºä¸€è¡Œæ—¥å¿—ã€‚ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºæ¥ï¼Œå¯åŠ¨çš„åç¨‹æ˜¯è¿è¡Œåœ¨åç¨‹å†…éƒ¨çš„<strong>çº¿ç¨‹æ± </strong>ä¸­ã€‚è™½ç„¶ä»è¡¨ç°ç»“æœä¸Šæ¥çœ‹ï¼Œå¯åŠ¨ä¸€ä¸ªåç¨‹ç±»ä¼¼äºæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Thread æ¥æ‰§è¡Œè€—æ—¶ä»»åŠ¡ï¼Œä½†å®é™…ä¸Šåç¨‹å’Œçº¿ç¨‹æœ‰ç€æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚é€šè¿‡ä½¿ç”¨åç¨‹ï¼Œå¯ä»¥æå¤§çš„æé«˜çº¿ç¨‹çš„å¹¶å‘æ•ˆç‡ï¼Œé¿å…ä»¥å¾€çš„åµŒå¥—å›è°ƒåœ°ç‹±ï¼Œæå¤§æé«˜äº†ä»£ç çš„å¯è¯»æ€§</p><p>ä»¥ä¸Šä»£ç å°±æ¶‰åŠåˆ°äº†åç¨‹çš„å››ä¸ªåŸºç¡€æ¦‚å¿µï¼š</p><ul><li>suspend functionã€‚å³æŒ‚èµ·å‡½æ•°ï¼Œdelay() å°±æ˜¯åç¨‹åº“æä¾›çš„ä¸€ä¸ªç”¨äºå®ç°éé˜»å¡å¼å»¶æ—¶çš„æŒ‚èµ·å‡½æ•°</li><li>CoroutineScopeã€‚å³åç¨‹ä½œç”¨åŸŸï¼ŒGlobalScope æ˜¯ CoroutineScope çš„ä¸€ä¸ªå®ç°ç±»ï¼Œç”¨äºæŒ‡å®šåç¨‹çš„ä½œç”¨èŒƒå›´ï¼Œå¯ç”¨äºç®¡ç†å¤šä¸ªåç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€æœ‰åç¨‹éƒ½éœ€è¦é€šè¿‡ CoroutineScope æ¥å¯åŠ¨</li><li>CoroutineContextã€‚å³åç¨‹ä¸Šä¸‹æ–‡ï¼ŒåŒ…å«å¤šç§ç±»å‹çš„é…ç½®å‚æ•°ã€‚<code>Dispatchers.IO</code> å°±æ˜¯ CoroutineContext è¿™ä¸ªæŠ½è±¡æ¦‚å¿µçš„ä¸€ç§å®ç°ï¼Œç”¨äºæŒ‡å®šåç¨‹çš„è¿è¡Œè½½ä½“ï¼Œå³ç”¨äºæŒ‡å®šåç¨‹è¦è¿è¡Œåœ¨å“ªç±»çº¿ç¨‹ä¸Š</li><li>CoroutineBuilderã€‚å³åç¨‹æ„å»ºå™¨ï¼Œåç¨‹åœ¨ CoroutineScope çš„ä¸Šä¸‹æ–‡ä¸­é€šè¿‡ launchã€async ç­‰åç¨‹æ„å»ºå™¨æ¥è¿›è¡Œå£°æ˜å¹¶å¯åŠ¨ã€‚launchã€async å‡è¢«å£°æ˜ä¸º CoroutineScope çš„æ‰©å±•æ–¹æ³•</li></ul><h1 id="ä¸‰ã€suspend" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€suspend" aria-hidden="true">#</a> ä¸‰ã€suspend</h1><p>å¦‚æœä¸Šè¿°ä¾‹å­è¯•å›¾ç›´æ¥åœ¨ GlobalScope å¤–è°ƒç”¨ <code>delay()</code> å‡½æ•°çš„è¯ï¼ŒIDE å°±ä¼šæç¤ºä¸€ä¸ªé”™è¯¯ï¼š<strong>Suspend function &#39;delay&#39; should be called only from a coroutine or another suspend function</strong>ã€‚æ„æ€æ˜¯ï¼š<code>delay()</code> å‡½æ•°æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œåªèƒ½ç”±åç¨‹æˆ–è€…ç”±å…¶å®ƒæŒ‚èµ·å‡½æ•°æ¥è°ƒç”¨</p><p><code>delay()</code> å‡½æ•°å°±ä½¿ç”¨äº† suspend è¿›è¡Œä¿®é¥°ï¼Œç”¨ suspend ä¿®é¥°çš„å‡½æ•°å°±æ˜¯æŒ‚èµ·å‡½æ•°</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">delay</span><span class="token punctuation">(</span>timeMillis<span class="token operator">:</span> Long<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯»è€…åœ¨ç½‘ä¸Šçœ‹å…³äºåç¨‹çš„æ–‡ç« çš„æ—¶å€™ï¼Œåº”è¯¥ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¹ˆä¸€å¥è¯ï¼š<strong>æŒ‚èµ·å‡½æ•°ä¸ä¼šé˜»å¡å…¶æ‰€åœ¨çº¿ç¨‹ï¼Œè€Œæ˜¯ä¼šå°†åç¨‹æŒ‚èµ·ï¼Œåœ¨ç‰¹å®šçš„æ—¶å€™æ‰å†æ¢å¤æ‰§è¡Œ</strong></p><p>å¯¹äºè¿™å¥è¯æˆ‘çš„ç†è§£æ˜¯ï¼š<code>delay()</code> å‡½æ•°ç±»ä¼¼äº Java ä¸­çš„ <code>Thread.sleep()</code>ï¼Œè€Œä¹‹æ‰€ä»¥è¯´ <code>delay()</code> å‡½æ•°æ˜¯éé˜»å¡çš„ï¼Œæ˜¯å› ä¸ºå®ƒå’Œå•çº¯çš„çº¿ç¨‹ä¼‘çœ æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ã€‚ä¾‹å¦‚ï¼Œå½“åœ¨ ThreadA ä¸Šè¿è¡Œçš„ CoroutineA è°ƒç”¨äº†<code>delay(1000L)</code>å‡½æ•°æŒ‡å®šå»¶è¿Ÿä¸€ç§’åå†è¿è¡Œï¼ŒThreadA ä¼šè½¬è€Œå»æ‰§è¡Œ CoroutineBï¼Œç­‰åˆ°ä¸€ç§’åå†æ¥ç»§ç»­æ‰§è¡Œ CoroutineAã€‚æ‰€ä»¥ï¼ŒThreadA å¹¶ä¸ä¼šå› ä¸º CoroutineA çš„å»¶æ—¶è€Œé˜»å¡ï¼Œè€Œæ˜¯èƒ½ç»§ç»­å»æ‰§è¡Œå…¶å®ƒä»»åŠ¡ï¼Œæ‰€ä»¥æŒ‚èµ·å‡½æ•°å¹¶ä¸ä¼šé˜»å¡å…¶æ‰€åœ¨çº¿ç¨‹ï¼Œè¿™æ ·å°±æå¤§åœ°æé«˜äº†çº¿ç¨‹çš„å¹¶å‘çµæ´»åº¦ï¼Œæœ€å¤§åŒ–äº†çº¿ç¨‹çš„åˆ©ç”¨æ•ˆç‡ã€‚è€Œå¦‚æœæ˜¯ä½¿ç”¨<code>Thread.sleep()</code>çš„è¯ï¼Œçº¿ç¨‹å°±åªèƒ½å¹²ç­‰ç€è€Œä¸èƒ½å»æ‰§è¡Œå…¶å®ƒä»»åŠ¡ï¼Œé™ä½äº†çº¿ç¨‹çš„åˆ©ç”¨æ•ˆç‡</p><p>åç¨‹æ˜¯è¿è¡Œäºçº¿ç¨‹ä¸Šçš„ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¿è¡Œå¤šä¸ªï¼ˆå‡ åƒä¸Šä¸‡ä¸ªï¼‰åç¨‹ã€‚çº¿ç¨‹çš„è°ƒåº¦è¡Œä¸ºæ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥ç®¡ç†çš„ï¼Œè€Œåç¨‹çš„è°ƒåº¦è¡Œä¸ºæ˜¯å¯ä»¥ç”±å¼€å‘è€…æ¥æŒ‡å®šå¹¶ç”±ç¼–è¯‘å™¨æ¥å®ç°çš„ï¼Œåç¨‹èƒ½å¤Ÿç»†ç²’åº¦åœ°æ§åˆ¶å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶æœºå’Œæ‰§è¡Œçº¿ç¨‹ï¼Œå½“çº¿ç¨‹æ‰€æ‰§è¡Œçš„å½“å‰åç¨‹è¢« suspend åï¼Œè¯¥çº¿ç¨‹ä¹Ÿå¯ä»¥è…¾å‡ºèµ„æºå»å¤„ç†å…¶ä»–ä»»åŠ¡</p><h1 id="å››ã€suspend-æŒ‚èµ·ä¸æ¢å¤" tabindex="-1"><a class="header-anchor" href="#å››ã€suspend-æŒ‚èµ·ä¸æ¢å¤" aria-hidden="true">#</a> å››ã€suspend æŒ‚èµ·ä¸æ¢å¤</h1><p>åç¨‹åœ¨å¸¸è§„å‡½æ•°çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä¸¤é¡¹æ“ä½œç”¨äºå¤„ç†é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œåœ¨<code>invoke</code>ï¼ˆæˆ– <code>call</code>ï¼‰å’Œ<code>return</code>ä¹‹å¤–ï¼Œåç¨‹æ·»åŠ äº†<code>suspend</code>å’Œ <code>resume</code>ï¼š</p><ul><li><code>suspend</code> ç”¨äºæš‚åœæ‰§è¡Œå½“å‰åç¨‹ï¼Œå¹¶ä¿å­˜æ‰€æœ‰å±€éƒ¨å˜é‡</li><li><code>resume</code> ç”¨äºè®©å·²æš‚åœçš„åç¨‹ä»æš‚åœå¤„ç»§ç»­æ‰§è¡Œ</li></ul><p>suspend å‡½æ•°åªèƒ½ç”±å…¶å®ƒ suspend å‡½æ•°è°ƒç”¨ï¼Œæˆ–è€…æ˜¯ç”±åç¨‹æ¥è°ƒç”¨</p><p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†ä¸€é¡¹ä»»åŠ¡ï¼ˆå‡è®¾ get æ–¹æ³•æ˜¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ä»»åŠ¡ï¼‰çš„ç®€å•åç¨‹å®ç°ï¼š</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">fetchDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                             <span class="token comment">// Dispatchers.Main</span>
    <span class="token keyword">val</span> result <span class="token operator">=</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;https://developer.android.com&quot;</span></span><span class="token punctuation">)</span> <span class="token comment">// Dispatchers.IO for `get`</span>
    <span class="token function">show</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                                      <span class="token comment">// Dispatchers.Main</span>
<span class="token punctuation">}</span>

<span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">withContext</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>get()</code> ä»åœ¨ä¸»çº¿ç¨‹ä¸Šè¢«è°ƒç”¨ï¼Œä½†å®ƒä¼šåœ¨å¯åŠ¨ç½‘ç»œè¯·æ±‚ä¹‹å‰æš‚åœåç¨‹ã€‚<code>get()</code> ä¸»ä½“å†…é€šè¿‡è°ƒç”¨ <code>withContext(Dispatchers.IO)</code> åˆ›å»ºäº†ä¸€ä¸ªåœ¨ IO çº¿ç¨‹æ± ä¸­è¿è¡Œçš„ä»£ç å—ï¼Œåœ¨è¯¥å—å†…çš„ä»»ä½•ä»£ç éƒ½å§‹ç»ˆé€šè¿‡ IO è°ƒåº¦å™¨æ‰§è¡Œã€‚å½“ç½‘ç»œè¯·æ±‚å®Œæˆåï¼Œ<code>get()</code> ä¼šæ¢å¤å·²æš‚åœçš„åç¨‹ï¼Œä½¿å¾—ä¸»çº¿ç¨‹åç¨‹å¯ä»¥ç›´æ¥æ‹¿åˆ°ç½‘ç»œè¯·æ±‚ç»“æœè€Œä¸ç”¨ä½¿ç”¨å›è°ƒæ¥é€šçŸ¥ä¸»çº¿ç¨‹ã€‚Retrofit å°±æ˜¯ä»¥è¿™ç§æ–¹å¼æ¥å®ç°å¯¹åç¨‹çš„æ”¯æŒ</p><p>Kotlin ä½¿ç”¨ <strong>å †æ ˆå¸§</strong> æ¥ç®¡ç†è¦è¿è¡Œå“ªä¸ªå‡½æ•°ä»¥åŠæ‰€æœ‰å±€éƒ¨å˜é‡ã€‚æš‚åœåç¨‹æ—¶ï¼Œç³»ç»Ÿä¼šå¤åˆ¶å¹¶ä¿å­˜å½“å‰çš„å †æ ˆå¸§ä»¥ä¾›ç¨åä½¿ç”¨ã€‚æ¢å¤æ—¶ï¼Œä¼šå°†å †æ ˆå¸§ä»å…¶ä¿å­˜çš„ä½ç½®å¤åˆ¶å›æ¥ï¼Œç„¶åå‡½æ•°å†æ¬¡å¼€å§‹è¿è¡Œã€‚è™½ç„¶ä»£ç å¯èƒ½çœ‹èµ·æ¥åƒæ™®é€šçš„é¡ºåºé˜»å¡è¯·æ±‚ï¼Œåç¨‹ä¹Ÿèƒ½ç¡®ä¿ç½‘ç»œè¯·æ±‚ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</p><p>åœ¨ä¸»çº¿ç¨‹è¿›è¡Œçš„ <strong>æš‚åœåç¨‹</strong> å’Œ <strong>æ¢å¤åç¨‹</strong> çš„ä¸¤ä¸ªæ“ä½œï¼Œæ—¢å®ç°äº†å°†è€—æ—¶ä»»åŠ¡äº¤ç”±åå°çº¿ç¨‹å®Œæˆï¼Œä¿éšœäº†ä¸»çº¿ç¨‹å®‰å…¨ï¼Œåˆä»¥åŒæ­¥ä»£ç çš„æ–¹å¼å®Œæˆäº†å®é™…ä¸Šçš„å¤šçº¿ç¨‹å¼‚æ­¥è°ƒç”¨ã€‚å¯ä»¥è¯´ï¼Œåœ¨ Android å¹³å°ä¸Šåç¨‹ä¸»è¦å°±ç”¨æ¥è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¤„ç†è€—æ—¶ä»»åŠ¡ (Long running tasks)ï¼Œè¿™ç§ä»»åŠ¡å¸¸å¸¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</li><li>ä¿è¯ä¸»çº¿ç¨‹å®‰å…¨ (Main-safety)ï¼Œå³ç¡®ä¿å®‰å…¨åœ°ä»ä¸»çº¿ç¨‹è°ƒç”¨ä»»ä½• suspend å‡½æ•°</li></ol><h1 id="äº”ã€coroutinescope" tabindex="-1"><a class="header-anchor" href="#äº”ã€coroutinescope" aria-hidden="true">#</a> äº”ã€CoroutineScope</h1><p>CoroutineScope å³ <strong>åç¨‹ä½œç”¨åŸŸ</strong>ï¼Œç”¨äºå¯¹åç¨‹è¿›è¡Œè¿½è¸ªã€‚å¦‚æœæˆ‘ä»¬å¯åŠ¨äº†å¤šä¸ªåç¨‹ä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªå¯ä»¥å¯¹å…¶è¿›è¡Œç»Ÿä¸€ç®¡ç†çš„é€”å¾„çš„è¯ï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„ä»£ç è‡ƒè‚¿æ‚ä¹±ï¼Œç”šè‡³å‘ç”Ÿ<strong>å†…å­˜æ³„éœ²</strong>æˆ–è€…<strong>ä»»åŠ¡æ³„éœ²</strong>ã€‚ä¸ºäº†ç¡®ä¿æ‰€æœ‰çš„åç¨‹éƒ½ä¼šè¢«è¿½è¸ªï¼ŒKotlin ä¸å…è®¸åœ¨æ²¡æœ‰ CoroutineScope çš„æƒ…å†µä¸‹å¯åŠ¨åç¨‹ã€‚CoroutineScope å¯è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå…·æœ‰è¶…èƒ½åŠ›çš„ ExecutorService çš„è½»é‡çº§ç‰ˆæœ¬ã€‚å®ƒèƒ½å¯åŠ¨åç¨‹ï¼ŒåŒæ—¶è¿™ä¸ªåç¨‹è¿˜å…·å¤‡ä¸Šæ–‡æ‰€è¯´çš„ suspend å’Œ resume çš„ä¼˜åŠ¿</p><p>æ‰€æœ‰çš„åç¨‹éƒ½éœ€è¦é€šè¿‡ CoroutineScope æ¥å¯åŠ¨ï¼Œå®ƒä¼šè·Ÿè¸ªé€šè¿‡ <code>launch</code> æˆ– <code>async</code> åˆ›å»ºçš„æ‰€æœ‰åç¨‹ï¼Œä½ å¯ä»¥éšæ—¶è°ƒç”¨ <code>scope.cancel()</code> å–æ¶ˆæ­£åœ¨è¿è¡Œçš„åç¨‹ã€‚CoroutineScope æœ¬èº«å¹¶ä¸è¿è¡Œåç¨‹ï¼Œå®ƒåªæ˜¯ç¡®ä¿ä½ ä¸ä¼šå¤±å»å¯¹åç¨‹çš„è¿½è¸ªï¼Œå³ä½¿åç¨‹è¢«æŒ‚èµ·ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åœ¨ Android ä¸­ï¼ŒæŸäº› ktx åº“ä¸ºæŸäº›ç”Ÿå‘½å‘¨æœŸç±»æä¾›äº†è‡ªå·±çš„ CoroutineScopeï¼Œä¾‹å¦‚ï¼ŒViewModel æœ‰ <code>viewModelScope</code>ï¼ŒLifecycle æœ‰ <code>lifecycleScope</code></p><p>CoroutineScope å¤§ä½“ä¸Šå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š</p><ul><li>GlobalScopeã€‚å³å…¨å±€åç¨‹ä½œç”¨åŸŸï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…å¯åŠ¨çš„åç¨‹å¯ä»¥ä¸€ç›´è¿è¡Œç›´åˆ°åº”ç”¨åœæ­¢è¿è¡Œã€‚GlobalScope æœ¬èº«ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œä¸”å¯åŠ¨çš„åç¨‹ç›¸å½“äºå®ˆæŠ¤çº¿ç¨‹ï¼Œä¸ä¼šé˜»æ­¢ JVM ç»“æŸè¿è¡Œ</li><li>runBlockingã€‚ä¸€ä¸ªé¡¶å±‚å‡½æ•°ï¼Œå’Œ GlobalScope ä¸ä¸€æ ·ï¼Œå®ƒä¼šé˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°å…¶å†…éƒ¨æ‰€æœ‰ç›¸åŒä½œç”¨åŸŸçš„åç¨‹æ‰§è¡Œç»“æŸ</li><li>è‡ªå®šä¹‰ CoroutineScopeã€‚å¯ç”¨äºå®ç°ä¸»åŠ¨æ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´ï¼Œå¯¹äº Android å¼€å‘æ¥è¯´æœ€å¤§æ„ä¹‰ä¹‹ä¸€å°±æ˜¯å¯ä»¥åœ¨ Activityã€Fragmentã€ViewModel ç­‰å…·æœ‰ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ä¸­æŒ‰éœ€å–æ¶ˆæ‰€æœ‰åç¨‹ä»»åŠ¡ï¼Œä»è€Œç¡®ä¿ç”Ÿå‘½å‘¨æœŸå®‰å…¨ï¼Œé¿å…å†…å­˜æ³„éœ²</li></ul><h2 id="_1ã€globalscope" tabindex="-1"><a class="header-anchor" href="#_1ã€globalscope" aria-hidden="true">#</a> 1ã€GlobalScope</h2><p>GlobalScope å±äº <strong>å…¨å±€ä½œç”¨åŸŸ</strong>ï¼Œè¿™æ„å‘³ç€é€šè¿‡ GlobalScope å¯åŠ¨çš„åç¨‹çš„ç”Ÿå‘½å‘¨æœŸåªå—æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸçš„é™åˆ¶ï¼Œåªè¦æ•´ä¸ªåº”ç”¨ç¨‹åºè¿˜åœ¨è¿è¡Œä¸”åç¨‹çš„ä»»åŠ¡è¿˜æœªç»“æŸï¼Œåç¨‹å°±å¯ä»¥ä¸€ç›´è¿è¡Œ</p><p>GlobalScope ä¸ä¼šé˜»å¡å…¶æ‰€åœ¨çº¿ç¨‹ï¼Œæ‰€ä»¥ä»¥ä¸‹ä»£ç ä¸­ä¸»çº¿ç¨‹çš„æ—¥å¿—ä¼šæ—©äº GlobalScope å†…éƒ¨è¾“å‡ºæ—¥å¿—ã€‚æ­¤å¤–ï¼ŒGlobalScope å¯åŠ¨çš„åç¨‹ç›¸å½“äºå®ˆæŠ¤çº¿ç¨‹ï¼Œä¸ä¼šé˜»æ­¢ JVM ç»“æŸè¿è¡Œï¼Œæ‰€ä»¥å¦‚æœå°†ä¸»çº¿ç¨‹çš„ä¼‘çœ æ—¶é—´æ”¹ä¸ºä¸‰ç™¾æ¯«ç§’çš„è¯ï¼Œå°±ä¸ä¼šçœ‹åˆ° launch A è¾“å‡ºæ—¥å¿—</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;start&quot;</span></span><span class="token punctuation">)</span>
    GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launch A&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launch B&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;GlobalScope&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> start
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> end
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> GlobalScope
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> launch B
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> launch A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>GlobalScope.launch</code> ä¼šåˆ›å»ºä¸€ä¸ªé¡¶çº§åç¨‹ï¼Œå°½ç®¡å®ƒå¾ˆè½»é‡çº§ï¼Œä½†åœ¨è¿è¡Œæ—¶è¿˜æ˜¯ä¼šæ¶ˆè€—ä¸€äº›å†…å­˜èµ„æºï¼Œä¸”å¯ä»¥ä¸€ç›´è¿è¡Œç›´åˆ°æ•´ä¸ªåº”ç”¨ç¨‹åºåœæ­¢ï¼ˆåªè¦ä»»åŠ¡è¿˜æœªç»“æŸï¼‰ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥åœ¨æ—¥å¸¸å¼€å‘ä¸­åº”è¯¥è°¨æ…ä½¿ç”¨ GlobalScope</p><h2 id="_2ã€runblocking" tabindex="-1"><a class="header-anchor" href="#_2ã€runblocking" aria-hidden="true">#</a> 2ã€runBlocking</h2><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ runBlocking è¿™ä¸ªé¡¶å±‚å‡½æ•°æ¥å¯åŠ¨åç¨‹ï¼ŒrunBlocking å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å³åç¨‹çš„æ‰§è¡Œä½“ï¼Œè¯¥å‚æ•°è¢«å£°æ˜ä¸º CoroutineScope çš„æ‰©å±•å‡½æ•°ï¼Œå› æ­¤æ‰§è¡Œä½“å°±åŒ…å«äº†ä¸€ä¸ªéšå¼çš„ CoroutineScopeï¼Œæ‰€ä»¥åœ¨ runBlocking å†…éƒ¨å¯ä»¥æ¥ç›´æ¥å¯åŠ¨åç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">runBlocking</span><span class="token punctuation">(</span>context<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> 
	EmptyCoroutineContext<span class="token punctuation">,</span> block<span class="token operator">:</span> <span class="token keyword">suspend</span> CoroutineScope<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> T<span class="token punctuation">)</span><span class="token operator">:</span> T
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>runBlocking çš„ä¸€ä¸ªæ–¹ä¾¿ä¹‹å¤„å°±æ˜¯ï¼šåªæœ‰å½“å†…éƒ¨<strong>ç›¸åŒä½œç”¨åŸŸ</strong>çš„æ‰€æœ‰åç¨‹éƒ½è¿è¡Œç»“æŸåï¼Œå£°æ˜åœ¨ runBlocking ä¹‹åçš„ä»£ç æ‰èƒ½æ‰§è¡Œï¼Œå³ runBlocking ä¼šé˜»å¡å…¶æ‰€åœ¨çº¿ç¨‹</p><p>çœ‹ä»¥ä¸‹ä»£ç ã€‚runBlocking å†…éƒ¨å¯åŠ¨çš„ä¸¤ä¸ªåç¨‹ä¼šå„è‡ªåšè€—æ—¶æ“ä½œï¼Œä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºæ¥ä¸¤ä¸ªåç¨‹è¿˜æ˜¯åœ¨äº¤å‰å¹¶å‘æ‰§è¡Œï¼Œä¸” runBlocking ä¼šç­‰åˆ°ä¸¤ä¸ªåç¨‹éƒ½æ‰§è¡Œç»“æŸåæ‰ä¼šé€€å‡ºï¼Œå¤–éƒ¨çš„æ—¥å¿—è¾“å‡ºç»“æœæœ‰æ˜ç¡®çš„å…ˆåé¡ºåºã€‚å³ runBlocking å†…éƒ¨å¯åŠ¨çš„åç¨‹æ˜¯éé˜»å¡å¼çš„ï¼Œä½† runBlocking é˜»å¡äº†å…¶æ‰€åœ¨çº¿ç¨‹ã€‚æ­¤å¤–ï¼ŒrunBlocking åªä¼šç­‰å¾…ç›¸åŒä½œç”¨åŸŸçš„åç¨‹å®Œæˆæ‰ä¼šé€€å‡ºï¼Œè€Œä¸ä¼šç­‰å¾… GlobalScope ç­‰å…¶å®ƒä½œç”¨åŸŸå¯åŠ¨çš„åç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;start&quot;</span></span><span class="token punctuation">)</span>
    runBlocking <span class="token punctuation">{</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchA - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchB - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;GlobalScope - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> start
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">0</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> GlobalScope <span class="token operator">-</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">1</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> GlobalScope <span class="token operator">-</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> end
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰€ä»¥è¯´ï¼ŒrunBlocking æœ¬èº«å¸¦æœ‰é˜»å¡çº¿ç¨‹çš„æ„å‘³ï¼Œä½†å…¶å†…éƒ¨è¿è¡Œçš„åç¨‹åˆæ˜¯éé˜»å¡çš„ï¼Œè¯»è€…éœ€è¦æ˜ç™½è¿™ä¸¤è€…çš„åŒºåˆ«</strong></p><p>åŸºäºæ˜¯å¦ä¼šé˜»å¡çº¿ç¨‹çš„åŒºåˆ«ï¼Œä»¥ä¸‹ä»£ç ä¸­ runBlocking ä¼šæ—©äº GlobalScope è¾“å‡ºæ—¥å¿—</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;GlobalScope&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    runBlocking <span class="token punctuation">{</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;runBlocking&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ä¸»åŠ¨ä¼‘çœ ä¸¤ç™¾æ¯«ç§’ï¼Œä½¿å¾—å’Œ runBlocking åŠ èµ·æ¥çš„å»¶è¿Ÿæ—¶é—´å¤šäºå…­ç™¾æ¯«ç§’</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;after sleep&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> runBlocking
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> GlobalScope
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> after sleep
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3ã€coroutinescope" tabindex="-1"><a class="header-anchor" href="#_3ã€coroutinescope" aria-hidden="true">#</a> 3ã€coroutineScope</h2><p><code>coroutineScope</code> å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„åç¨‹ä½œç”¨åŸŸï¼Œç›´åˆ°æ‰€æœ‰å¯åŠ¨çš„åç¨‹éƒ½å®Œæˆåæ‰ç»“æŸè‡ªèº«ã€‚<code>runBlocking</code> å’Œ <code>coroutineScope</code> çœ‹èµ·æ¥å¾ˆåƒï¼Œå› ä¸ºå®ƒä»¬éƒ½éœ€è¦ç­‰å¾…å…¶å†…éƒ¨æ‰€æœ‰ç›¸åŒä½œç”¨åŸŸçš„åç¨‹ç»“æŸåæ‰ä¼šç»“æŸè‡ªå·±ã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äº <code>runBlocking</code> æ–¹æ³•ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œè€Œ <code>coroutineScope</code>ä¸ä¼šï¼Œè€Œæ˜¯ä¼šæŒ‚èµ·å¹¶é‡Šæ”¾åº•å±‚çº¿ç¨‹ä»¥ä¾›å…¶å®ƒåç¨‹ä½¿ç”¨ã€‚åŸºäºè¿™ä¸ªå·®åˆ«ï¼Œ<code>runBlocking</code> æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œ <code>coroutineScope</code> æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    launch <span class="token punctuation">{</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task from runBlocking&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    coroutineScope <span class="token punctuation">{</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task from nested launch&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task from coroutine scope&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Coroutine scope is over&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task from coroutine scope
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task from runBlocking
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task from nested launch
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Coroutine scope <span class="token keyword">is</span> over
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4ã€supervisorscope" tabindex="-1"><a class="header-anchor" href="#_4ã€supervisorscope" aria-hidden="true">#</a> 4ã€supervisorScope</h2><p><code>supervisorScope</code> å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªä½¿ç”¨äº† SupervisorJob çš„ coroutineScopeï¼Œè¯¥ä½œç”¨åŸŸçš„ç‰¹ç‚¹å°±æ˜¯æŠ›å‡ºçš„å¼‚å¸¸ä¸ä¼šè¿é”å–æ¶ˆåŒçº§åç¨‹å’Œçˆ¶åç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    launch <span class="token punctuation">{</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task from runBlocking&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    supervisorScope <span class="token punctuation">{</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task throw Exception&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token function">Exception</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;failed&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Task from nested launch&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Coroutine scope is over&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task from runBlocking
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task <span class="token keyword">throw</span> Exception
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Task from nested launch
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Coroutine scope <span class="token keyword">is</span> over
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€è‡ªå®šä¹‰-coroutinescope" tabindex="-1"><a class="header-anchor" href="#_5ã€è‡ªå®šä¹‰-coroutinescope" aria-hidden="true">#</a> 5ã€è‡ªå®šä¹‰ CoroutineScope</h2><p>å‡è®¾æˆ‘ä»¬åœ¨ Activity ä¸­å…ˆåå¯åŠ¨äº†å¤šä¸ªåç¨‹ç”¨äºæ‰§è¡Œå¼‚æ­¥è€—æ—¶æ“ä½œï¼Œé‚£ä¹ˆå½“ Activity é€€å‡ºæ—¶ï¼Œå¿…é¡»å–æ¶ˆæ‰€æœ‰åç¨‹ä»¥é¿å…å†…å­˜æ³„æ¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿ç•™æ¯ä¸€ä¸ª Job å¼•ç”¨ç„¶ååœ¨ <code>onDestroy</code>æ–¹æ³•é‡Œæ¥æ‰‹åŠ¨å–æ¶ˆï¼Œä½†è¿™ç§æ–¹å¼ç›¸å½“æ¥è¯´ä¼šæ¯”è¾ƒç¹çå’Œä½æ•ˆã€‚kotlinx.coroutines æä¾›äº† CoroutineScope æ¥ç®¡ç†å¤šä¸ªåç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºä¸ Activity ç”Ÿå‘½å‘¨æœŸç›¸å…³è”çš„åç¨‹ä½œç”¨åŸŸæ¥ç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚CoroutineScope çš„å®ä¾‹å¯ä»¥é€šè¿‡ <code>CoroutineScope()</code> æˆ– <code>MainScope()</code> çš„å·¥å‚å‡½æ•°æ¥æ„å»ºã€‚å‰è€…åˆ›å»ºé€šç”¨ä½œç”¨åŸŸï¼Œåè€…åˆ›å»º UI åº”ç”¨ç¨‹åºçš„ä½œç”¨åŸŸå¹¶ä½¿ç”¨ Dispatchers.Main ä½œä¸ºé»˜è®¤çš„è°ƒåº¦å™¨</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">class</span> Activity <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">val</span> mainScope <span class="token operator">=</span> <span class="token function">MainScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mainScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000L</span> <span class="token operator">*</span> it<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mainScope<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å§”æ‰˜æ¨¡å¼æ¥è®© Activity å®ç° CoroutineScope æ¥å£ï¼Œä»è€Œå¯ä»¥åœ¨ Activity å†…ç›´æ¥å¯åŠ¨åç¨‹è€Œä¸å¿…æ˜¾ç¤ºåœ°æŒ‡å®šå®ƒä»¬çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”åœ¨ <code>onDestroy()</code>ä¸­è‡ªåŠ¨å–æ¶ˆæ‰€æœ‰åç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">class</span> Activity <span class="token operator">:</span> CoroutineScope <span class="token keyword">by</span> <span class="token function">CoroutineScope</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Default<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        launch <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">200L</span> <span class="token operator">*</span> it<span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Activity Created&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Activity Destroyed&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> activity <span class="token operator">=</span> <span class="token function">Activity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    activity<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
    activity<span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå½“å›è°ƒäº†<code>onDestroy()</code>æ–¹æ³•ååç¨‹å°±ä¸ä¼šå†è¾“å‡ºæ—¥å¿—äº†</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> Activity Created
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">0</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">1</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Activity Destroyed
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å·²å–æ¶ˆçš„ä½œç”¨åŸŸæ— æ³•å†åˆ›å»ºåç¨‹ã€‚å› æ­¤ï¼Œä»…å½“æ§åˆ¶å…¶ç”Ÿå‘½å‘¨æœŸçš„ç±»è¢«é”€æ¯æ—¶ï¼Œæ‰åº”è°ƒç”¨ <code>scope.cancel()</code>ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>viewModelScope</code> æ—¶ï¼Œ ViewModel ä¼šåœ¨è‡ªèº«çš„ <code>onCleared()</code> æ–¹æ³•ä¸­è‡ªåŠ¨å–æ¶ˆä½œç”¨åŸŸ</p><h1 id="å…­ã€coroutinebuilder" tabindex="-1"><a class="header-anchor" href="#å…­ã€coroutinebuilder" aria-hidden="true">#</a> å…­ã€CoroutineBuilder</h1><h2 id="_1ã€launch" tabindex="-1"><a class="header-anchor" href="#_1ã€launch" aria-hidden="true">#</a> 1ã€launch</h2><p>çœ‹ä¸‹ <code>launch</code> å‡½æ•°çš„æ–¹æ³•ç­¾åã€‚<code>launch</code> æ˜¯ä¸€ä¸ªä½œç”¨äº CoroutineScope çš„æ‰©å±•å‡½æ•°ï¼Œç”¨äºåœ¨ä¸é˜»å¡å½“å‰çº¿ç¨‹çš„æƒ…å†µä¸‹å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œå¹¶è¿”å›å¯¹è¯¥åç¨‹ä»»åŠ¡çš„å¼•ç”¨ï¼Œå³ Job å¯¹è±¡</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">fun</span> CoroutineScope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>
    context<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> EmptyCoroutineContext<span class="token punctuation">,</span>
    start<span class="token operator">:</span> CoroutineStart <span class="token operator">=</span> CoroutineStart<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span>
    block<span class="token operator">:</span> <span class="token keyword">suspend</span> CoroutineScope<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span><span class="token operator">:</span> Job
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>launch</code> å‡½æ•°å…±åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼š</p><ol><li>contextã€‚ç”¨äºæŒ‡å®šåç¨‹çš„ä¸Šä¸‹æ–‡</li><li>startã€‚ç”¨äºæŒ‡å®šåç¨‹çš„å¯åŠ¨æ–¹å¼ï¼Œé»˜è®¤å€¼ä¸º <code>CoroutineStart.DEFAULT</code>ï¼Œå³åç¨‹ä¼šåœ¨å£°æ˜çš„åŒæ—¶å°±ç«‹å³è¿›å…¥ç­‰å¾…è°ƒåº¦çš„çŠ¶æ€ï¼Œå³å¯ä»¥ç«‹å³æ‰§è¡Œçš„çŠ¶æ€ã€‚å¯ä»¥é€šè¿‡å°†å…¶è®¾ç½®ä¸º<code>CoroutineStart.LAZY</code>æ¥å®ç°å»¶è¿Ÿå¯åŠ¨ï¼Œå³æ‡’åŠ è½½</li><li>blockã€‚ç”¨äºä¼ é€’åç¨‹çš„æ‰§è¡Œä½“ï¼Œå³å¸Œæœ›äº¤ç”±åç¨‹æ‰§è¡Œçš„ä»»åŠ¡</li></ol><p>å¯ä»¥çœ‹åˆ° launchA å’Œ launchB æ˜¯å¹¶è¡Œäº¤å‰æ‰§è¡Œçš„</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> launchA <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchA - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> launchB <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchB - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA <span class="token operator">-</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB <span class="token operator">-</span> <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2ã€job" tabindex="-1"><a class="header-anchor" href="#_2ã€job" aria-hidden="true">#</a> 2ã€Job</h2><p>Job æ˜¯åç¨‹çš„å¥æŸ„ã€‚ä½¿ç”¨ <code>launch</code> æˆ– <code>async</code> åˆ›å»ºçš„æ¯ä¸ªåç¨‹éƒ½ä¼šè¿”å›ä¸€ä¸ª Job å®ä¾‹ï¼Œè¯¥å®ä¾‹å”¯ä¸€æ ‡è¯†åç¨‹å¹¶ç®¡ç†å…¶ç”Ÿå‘½å‘¨æœŸã€‚Job æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œè¿™é‡Œåˆ—ä¸¾ Job å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å±æ€§å’Œå‡½æ•°</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token comment">//å½“ Job å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ä¸º true</span>
<span class="token comment">//å¦‚æœ Job æœªè¢«å–æ¶ˆæˆ–æ²¡æœ‰å¤±è´¥ï¼Œåˆ™å‡å¤„äº active çŠ¶æ€</span>
<span class="token keyword">public</span> <span class="token keyword">val</span> isActive<span class="token operator">:</span> Boolean

<span class="token comment">//å½“ Job æ­£å¸¸ç»“æŸæˆ–è€…ç”±äºå¼‚å¸¸ç»“æŸï¼Œå‡è¿”å› true</span>
<span class="token keyword">public</span> <span class="token keyword">val</span> isCompleted<span class="token operator">:</span> Boolean

<span class="token comment">//å½“ Job è¢«ä¸»åŠ¨å–æ¶ˆæˆ–è€…ç”±äºå¼‚å¸¸ç»“æŸï¼Œå‡è¿”å› true</span>
<span class="token keyword">public</span> <span class="token keyword">val</span> isCancelled<span class="token operator">:</span> Boolean

<span class="token comment">//å¯åŠ¨ Job</span>
<span class="token comment">//å¦‚æœæ­¤è°ƒç”¨çš„ç¡®å¯åŠ¨äº† Jobï¼Œåˆ™è¿”å› true</span>
<span class="token comment">//å¦‚æœ Job è°ƒç”¨å‰å°±å·²å¤„äº started æˆ–è€…æ˜¯ completed çŠ¶æ€ï¼Œåˆ™è¿”å› false </span>
<span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean

<span class="token comment">//ç”¨äºå–æ¶ˆ Jobï¼Œå¯åŒæ—¶é€šè¿‡ä¼ å…¥ Exception æ¥æ ‡æ˜å–æ¶ˆåŸå› </span>
<span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token function">cancel</span><span class="token punctuation">(</span>cause<span class="token operator">:</span> CancellationException<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>

<span class="token comment">//é˜»å¡ç­‰å¾…ç›´åˆ°æ­¤ Job ç»“æŸè¿è¡Œ</span>
<span class="token keyword">public</span> <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//å½“ Job ç»“æŸè¿è¡Œæ—¶ï¼ˆä¸ç®¡ç”±äºä»€ä¹ˆåŸå› ï¼‰å›è°ƒæ­¤æ–¹æ³•ï¼Œå¯ç”¨äºæ¥æ”¶å¯èƒ½å­˜åœ¨çš„è¿è¡Œå¼‚å¸¸</span>
<span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token function">invokeOnCompletion</span><span class="token punctuation">(</span>handler<span class="token operator">:</span> CompletionHandler<span class="token punctuation">)</span><span class="token operator">:</span> DisposableHandle
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Job å…·æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€å€¼ï¼Œæ¯ç§çŠ¶æ€å¯¹åº”çš„å±æ€§å€¼å„ä¸ç›¸åŒ</p><table><thead><tr><th style="text-align:left;"><strong>State</strong></th><th style="text-align:left;"><a href="https://Kotlin.github.io/Kotlinx.coroutines/Kotlinx-coroutines-core/Kotlinx.coroutines/-job/is-active.html" target="_blank" rel="noopener noreferrer">isActive<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></th><th style="text-align:left;"><a href="https://Kotlin.github.io/Kotlinx.coroutines/Kotlinx-coroutines-core/Kotlinx.coroutines/-job/is-completed.html" target="_blank" rel="noopener noreferrer">isCompleted<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></th><th style="text-align:left;"><a href="https://Kotlin.github.io/Kotlinx.coroutines/Kotlinx-coroutines-core/Kotlinx.coroutines/-job/is-cancelled.html" target="_blank" rel="noopener noreferrer">isCancelled<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></th></tr></thead><tbody><tr><td style="text-align:left;"><em>New</em> (optional initial state)</td><td style="text-align:left;">false</td><td style="text-align:left;">false</td><td style="text-align:left;">false</td></tr><tr><td style="text-align:left;"><em>Active</em> (default initial state)</td><td style="text-align:left;">true</td><td style="text-align:left;">false</td><td style="text-align:left;">false</td></tr><tr><td style="text-align:left;"><em>Completing</em> (transient state)</td><td style="text-align:left;">true</td><td style="text-align:left;">false</td><td style="text-align:left;">false</td></tr><tr><td style="text-align:left;"><em>Cancelling</em> (transient state)</td><td style="text-align:left;">false</td><td style="text-align:left;">false</td><td style="text-align:left;">true</td></tr><tr><td style="text-align:left;"><em>Cancelled</em> (final state)</td><td style="text-align:left;">false</td><td style="text-align:left;">true</td><td style="text-align:left;">true</td></tr><tr><td style="text-align:left;"><em>Completed</em> (final state)</td><td style="text-align:left;">false</td><td style="text-align:left;">true</td><td style="text-align:left;">false</td></tr></tbody></table><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å°†åç¨‹è®¾ç½®ä¸ºå»¶è¿Ÿå¯åŠ¨</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>start <span class="token operator">=</span> CoroutineStart<span class="token punctuation">.</span>LAZY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">..</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ¯å¾ªç¯ä¸€æ¬¡å‡å»¶è¿Ÿä¸€ç™¾æ¯«ç§’</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    job<span class="token punctuation">.</span><span class="token function">invokeOnCompletion</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;invokeOnCompletionï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;1. job.isActiveï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isActive</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;1. job.isCancelledï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCancelled</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;1. job.isCompletedï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCompleted</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    job<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;2. job.isActiveï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isActive</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;2. job.isCancelledï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCancelled</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;2. job.isCompletedï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCompleted</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

    <span class="token comment">//ä¼‘çœ å››ç™¾æ¯«ç§’åå†ä¸»åŠ¨å–æ¶ˆåç¨‹</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token function">CancellationException</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;test&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">//ä¼‘çœ å››ç™¾æ¯«ç§’é˜²æ­¢JVMè¿‡å¿«åœæ­¢å¯¼è‡´ invokeOnCompletion æ¥ä¸åŠå›è°ƒ</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>

    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;3. job.isActiveï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isActive</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;3. job.isCancelledï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCancelled</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;3. job.isCompletedï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">job<span class="token punctuation">.</span>isCompleted</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isActiveï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCancelledï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">1</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCompletedï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">2</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isActiveï¼š<span class="token boolean">true</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">2</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCancelledï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">2</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCompletedï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> invokeOnCompletionï¼šjava<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CancellationException<span class="token operator">:</span> test
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">3</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isActiveï¼š<span class="token boolean">false</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">3</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCancelledï¼š<span class="token boolean">true</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">3</span><span class="token punctuation">.</span> job<span class="token punctuation">.</span>isCompletedï¼š<span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3ã€async" tabindex="-1"><a class="header-anchor" href="#_3ã€async" aria-hidden="true">#</a> 3ã€async</h2><p>çœ‹ä¸‹ <code>async</code> å‡½æ•°çš„æ–¹æ³•ç­¾åã€‚<code>async</code> ä¹Ÿæ˜¯ä¸€ä¸ªä½œç”¨äº CoroutineScope çš„æ‰©å±•å‡½æ•°ï¼Œå’Œ <code>launch</code> çš„åŒºåˆ«ä¸»è¦å°±åœ¨äºï¼š<code>async</code> å¯ä»¥è¿”å›åç¨‹çš„æ‰§è¡Œç»“æœï¼Œè€Œ <code>launch</code> ä¸è¡Œ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> CoroutineScope<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>
    context<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> EmptyCoroutineContext<span class="token punctuation">,</span>
    start<span class="token operator">:</span> CoroutineStart <span class="token operator">=</span> CoroutineStart<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span>
    block<span class="token operator">:</span> <span class="token keyword">suspend</span> CoroutineScope<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> T
<span class="token punctuation">)</span><span class="token operator">:</span> Deferred<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡<code>await()</code>æ–¹æ³•å¯ä»¥æ‹¿åˆ° async åç¨‹çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåç¨‹çš„æ€»è€—æ—¶æ˜¯è¿œå°‘äºä¸ƒç§’çš„ï¼Œæ€»è€—æ—¶åŸºæœ¬ç­‰äºè€—æ—¶æœ€é•¿çš„åç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> time <span class="token operator">=</span> measureTimeMillis <span class="token punctuation">{</span>
        runBlocking <span class="token punctuation">{</span>
            <span class="token keyword">val</span> asyncA <span class="token operator">=</span> async <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
                <span class="token number">1</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">val</span> asyncB <span class="token operator">=</span> async <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>
                <span class="token number">2</span>
            <span class="token punctuation">}</span>
            <span class="token function">log</span><span class="token punctuation">(</span>asyncA<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> asyncB<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">3</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">4070</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ç”±äº launch å’Œ async ä»…èƒ½å¤Ÿåœ¨ CouroutineScope ä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥ä»»ä½•åˆ›å»ºçš„åç¨‹éƒ½ä¼šè¢«è¯¥ scope è¿½è¸ªã€‚Kotlin ç¦æ­¢åˆ›å»ºä¸èƒ½å¤Ÿè¢«è¿½è¸ªçš„åç¨‹ï¼Œä»è€Œé¿å…åç¨‹æ³„æ¼</p></blockquote><h2 id="_4ã€async-é”™è¯¯ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#_4ã€async-é”™è¯¯ç”¨æ³•" aria-hidden="true">#</a> 4ã€async é”™è¯¯ç”¨æ³•</h2><p>ä¿®æ”¹ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥å‘ç°ä¸¤ä¸ªåç¨‹çš„æ€»è€—æ—¶å°±ä¼šå˜ä¸ºä¸ƒç§’å·¦å³</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> time <span class="token operator">=</span> measureTimeMillis <span class="token punctuation">{</span>
        runBlocking <span class="token punctuation">{</span>
            <span class="token keyword">val</span> asyncA <span class="token operator">=</span> <span class="token function">async</span><span class="token punctuation">(</span>start <span class="token operator">=</span> CoroutineStart<span class="token punctuation">.</span>LAZY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
                <span class="token number">1</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">val</span> asyncB <span class="token operator">=</span> <span class="token function">async</span><span class="token punctuation">(</span>start <span class="token operator">=</span> CoroutineStart<span class="token punctuation">.</span>LAZY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>
                <span class="token number">2</span>
            <span class="token punctuation">}</span>
            <span class="token function">log</span><span class="token punctuation">(</span>asyncA<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> asyncB<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">3</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token number">7077</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼šé€ æˆè¿™ä¸åŒåŒºåˆ«æ˜¯å› ä¸º <code>CoroutineStart.LAZY</code> ä¸ä¼šä¸»åŠ¨å¯åŠ¨åç¨‹ï¼Œè€Œæ˜¯ç›´åˆ°è°ƒç”¨<code>async.await()</code>æˆ–è€…<code>async.satrt()</code>åæ‰ä¼šå¯åŠ¨ï¼ˆå³æ‡’åŠ è½½æ¨¡å¼ï¼‰ï¼Œæ‰€ä»¥<code>asyncA.await() + asyncB.await()</code>ä¼šå¯¼è‡´ä¸¤ä¸ªåç¨‹å…¶å®æ˜¯åœ¨é¡ºåºæ‰§è¡Œã€‚è€Œé»˜è®¤å€¼ <code>CoroutineStart.DEFAULT</code> å‚æ•°ä¼šä½¿å¾—åç¨‹åœ¨å£°æ˜çš„åŒæ—¶å°±è¢«å¯åŠ¨äº†ï¼ˆå®é™…ä¸Šè¿˜éœ€è¦ç­‰å¾…è¢«è°ƒåº¦æ‰§è¡Œï¼Œä½†å¯ä»¥çœ‹åšæ˜¯ç«‹å³å°±æ‰§è¡Œäº†ï¼‰ï¼Œæ‰€ä»¥æ­¤æ—¶è°ƒç”¨ç¬¬ä¸€ä¸ª <code>async.await()</code>æ—¶ä¸¤ä¸ªåç¨‹å…¶å®éƒ½æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œæ‰€ä»¥æ€»è€—æ—¶å°±æ˜¯å››ç§’å·¦å³</p><p>æ­¤æ—¶å¯ä»¥é€šè¿‡å…ˆè°ƒç”¨<code>start()</code>å†è°ƒç”¨<code>await()</code>æ¥å®ç°ç¬¬ä¸€ä¸ªä¾‹å­çš„æ•ˆæœ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code>asyncA<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
asyncB<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">log</span><span class="token punctuation">(</span>asyncA<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> asyncB<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€async-å¹¶è¡Œåˆ†è§£" tabindex="-1"><a class="header-anchor" href="#_5ã€async-å¹¶è¡Œåˆ†è§£" aria-hidden="true">#</a> 5ã€async å¹¶è¡Œåˆ†è§£</h2><p>ç”± <code>suspend</code> å‡½æ•°å¯åŠ¨çš„æ‰€æœ‰åç¨‹éƒ½å¿…é¡»åœ¨è¯¥å‡½æ•°è¿”å›ç»“æœæ—¶åœæ­¢ï¼Œå› æ­¤ä½ å¯èƒ½éœ€è¦ä¿è¯è¿™äº›åç¨‹åœ¨è¿”å›ç»“æœä¹‹å‰å®Œæˆã€‚å€ŸåŠ© Kotlin ä¸­çš„ç»“æ„åŒ–å¹¶å‘æœºåˆ¶ï¼Œä½ å¯ä»¥å®šä¹‰ç”¨äºå¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªåç¨‹çš„ <code>coroutineScope</code>ã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>await()</code>ï¼ˆé’ˆå¯¹å•ä¸ªåç¨‹ï¼‰æˆ– <code>awaitAll()</code>ï¼ˆé’ˆå¯¹å¤šä¸ªåç¨‹ï¼‰ä¿è¯è¿™äº›åç¨‹åœ¨ä»å‡½æ•°è¿”å›ç»“æœä¹‹å‰å®Œæˆ</p><p>å‡è®¾æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç”¨äºå¼‚æ­¥è·å–ä¸¤ä¸ªæ–‡æ¡£çš„ <code>coroutineScope</code>ï¼Œé€šè¿‡å¯¹æ¯ä¸ªå»¶è¿Ÿå¼•ç”¨è°ƒç”¨ <code>await()</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯è¿™ä¸¤é¡¹ <code>async</code> æ“ä½œåœ¨è¿”å›å€¼ä¹‹å‰å®Œæˆï¼š</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">fetchTwoDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> coroutineScope <span class="token punctuation">{</span>
    <span class="token keyword">val</span> deferredOne <span class="token operator">=</span> async <span class="token punctuation">{</span> <span class="token function">fetchDoc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token keyword">val</span> deferredTwo <span class="token operator">=</span> async <span class="token punctuation">{</span> <span class="token function">fetchDoc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    deferredOne<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    deferredTwo<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜å¯ä»¥å¯¹é›†åˆä½¿ç”¨ <code>awaitAll()</code>æ¥è¾¾åˆ°ç›¸åŒæ•ˆæœã€‚è™½ç„¶ <code>fetchTwoDocs()</code> ä½¿ç”¨ <code>async</code> å¯åŠ¨æ–°åç¨‹ï¼Œä½†è¯¥å‡½æ•°ä½¿ç”¨ <code>awaitAll()</code> ç­‰å¾…å¯åŠ¨çš„åç¨‹å®Œæˆåæ‰ä¼šè¿”å›ç»“æœã€‚ä¸è¿‡ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰è°ƒç”¨ <code>awaitAll()</code>ï¼Œ<code>coroutineScope</code> æ„å»ºå™¨ä¹Ÿä¼šç­‰åˆ°æ‰€æœ‰å†…éƒ¨åç¨‹éƒ½å®Œæˆåæ‰ä¼šæ¢å¤åä¸º <code>fetchTwoDocs</code> çš„åç¨‹ã€‚æ­¤å¤–ï¼Œ<code>coroutineScope</code> ä¼šæ•è·åç¨‹æŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶å°†å…¶ä¼ é€ç»™è°ƒç”¨æ–¹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">fetchTwoDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> coroutineScope <span class="token punctuation">{</span>
    <span class="token keyword">val</span> deferreds <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span>
        async <span class="token punctuation">{</span> <span class="token function">fetchDoc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        async <span class="token punctuation">{</span> <span class="token function">fetchDoc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    deferreds<span class="token punctuation">.</span><span class="token function">awaitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6ã€deferred" tabindex="-1"><a class="header-anchor" href="#_6ã€deferred" aria-hidden="true">#</a> 6ã€Deferred</h2><p><code>async</code> å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Deferred å¯¹è±¡ã€‚Deferred æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œç»§æ‰¿äº Job æ¥å£ï¼Œæ‰€ä»¥ Job åŒ…å«çš„å±æ€§å’Œæ–¹æ³• Deferred éƒ½æœ‰ï¼Œå…¶ä¸»è¦æ˜¯åœ¨ Job çš„åŸºç¡€ä¸Šæ‰©å±•äº† <code>await()</code>æ–¹æ³•</p><h1 id="ä¸ƒã€coroutinecontext" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€coroutinecontext" aria-hidden="true">#</a> ä¸ƒã€CoroutineContext</h1><p>CoroutineContext ä½¿ç”¨ä»¥ä¸‹å…ƒç´ é›†å®šä¹‰åç¨‹çš„è¡Œä¸ºï¼š</p><ul><li>Jobï¼šæ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</li><li>CoroutineDispatcherï¼šå°†ä»»åŠ¡æŒ‡æ´¾ç»™é€‚å½“çš„çº¿ç¨‹</li><li>CoroutineNameï¼šåç¨‹çš„åç§°ï¼Œå¯ç”¨äºè°ƒè¯•</li><li>CoroutineExceptionHandlerï¼šå¤„ç†æœªæ•è·çš„å¼‚å¸¸</li></ul><h2 id="_1ã€job" tabindex="-1"><a class="header-anchor" href="#_1ã€job" aria-hidden="true">#</a> 1ã€Job</h2><p>åç¨‹ä¸­çš„ Job æ˜¯å…¶ä¸Šä¸‹æ–‡ CoroutineContext ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡ <code>coroutineContext[Job]</code> è¡¨è¾¾å¼ä»ä¸Šä¸‹æ–‡ä¸­è·å–åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶ Job æ¥æ§åˆ¶ CoroutineScope çš„ç”Ÿå‘½å‘¨æœŸ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> scope <span class="token operator">=</span> <span class="token function">CoroutineScope</span><span class="token punctuation">(</span>job <span class="token operator">+</span> Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Unit <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">job</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> CancellationException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job is cancelled&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> e
        <span class="token punctuation">}</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;scope job is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">scope<span class="token punctuation">.</span>coroutineContext<span class="token punctuation">[</span>Job<span class="token punctuation">]</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    scope<span class="token punctuation">.</span>coroutineContext<span class="token punctuation">[</span>Job<span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> job <span class="token keyword">is</span> JobImpl<span class="token punctuation">{</span>Active<span class="token punctuation">}</span><span class="token label symbol">@759ebb3d</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> scope job <span class="token keyword">is</span> JobImpl<span class="token punctuation">{</span>Active<span class="token punctuation">}</span><span class="token label symbol">@759ebb3d</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job <span class="token keyword">is</span> cancelled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä¸Š CoroutineScope çš„ <code>isActive</code> è¿™ä¸ªæ‰©å±•å±æ€§åªæ˜¯ <code>coroutineContext[Job]?.isActive ?: true</code> çš„ä¸€ç§ç®€ä¾¿å†™æ³•</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">val</span> CoroutineScope<span class="token punctuation">.</span>isActive<span class="token operator">:</span> Boolean
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> coroutineContext<span class="token punctuation">[</span>Job<span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">.</span>isActive <span class="token operator">?:</span> <span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2ã€coroutinedispatcher" tabindex="-1"><a class="header-anchor" href="#_2ã€coroutinedispatcher" aria-hidden="true">#</a> 2ã€CoroutineDispatcher</h2><p>CoroutineContext åŒ…å«ä¸€ä¸ª CoroutineDispatcherï¼ˆåç¨‹è°ƒåº¦å™¨ï¼‰ç”¨äºæŒ‡å®šæ‰§è¡Œåç¨‹çš„ç›®æ ‡è½½ä½“ï¼Œå³ <strong>è¿è¡Œäºå“ªä¸ªçº¿ç¨‹</strong>ã€‚CoroutineDispatcher å¯ä»¥å°†åç¨‹çš„æ‰§è¡Œæ“ä½œé™åˆ¶åœ¨ç‰¹å®šçº¿ç¨‹ä¸Šï¼Œä¹Ÿå¯ä»¥å°†å…¶åˆ†æ´¾åˆ°çº¿ç¨‹æ± ä¸­ï¼Œæˆ–è€…è®©å®ƒæ— é™åˆ¶åœ°è¿è¡Œã€‚æ‰€æœ‰çš„åç¨‹æ„é€ å™¨ï¼ˆå¦‚ launch å’Œ asyncï¼‰éƒ½æ¥å—ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå³ CoroutineContext ï¼Œè¯¥å‚æ•°å¯ç”¨äºæ˜¾å¼æŒ‡å®šè¦åˆ›å»ºçš„åç¨‹å’Œå…¶å®ƒä¸Šä¸‹æ–‡å…ƒç´ æ‰€è¦ä½¿ç”¨çš„ CoroutineDispatcher</p><p>è¦åœ¨ä¸»çº¿ç¨‹ä¹‹å¤–è¿è¡Œä»£ç ï¼Œå¯ä»¥æŒ‡å®š Kotlin åç¨‹åœ¨ Default æˆ– IO è°ƒåº¦ç¨‹åºä¸Šæ‰§è¡Œå·¥ä½œã€‚åœ¨ Kotlin ä¸­ï¼Œæ‰€æœ‰åç¨‹éƒ½å¿…é¡»åœ¨ CoroutineDispatcher ä¸­è¿è¡Œï¼Œå³ä½¿å®ƒä»¬åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚åç¨‹å¯ä»¥è‡ªè¡Œæš‚åœï¼Œè€Œ CoroutineDispatcher è´Ÿè´£å°†å…¶æ¢å¤</p><p>Kotlin åç¨‹åº“æä¾›äº†å››ä¸ª Dispatcher ç”¨äºæŒ‡å®šåœ¨å“ªä¸€ç±»çº¿ç¨‹ä¸­æ‰§è¡Œåç¨‹ï¼š</p><ul><li>Dispatchers.Defaultã€‚é»˜è®¤è°ƒåº¦å™¨ï¼Œé€‚åˆç”¨äºæ‰§è¡Œå ç”¨å¤§é‡ CPU èµ„æºçš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼šå¯¹åˆ—è¡¨æ’åºå’Œè§£æ JSON</li><li>Dispatchers.IOã€‚é€‚åˆç”¨äºæ‰§è¡Œç£ç›˜æˆ–ç½‘ç»œ I/O çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨ Room ç»„ä»¶ã€è¯»å†™ç£ç›˜æ–‡ä»¶ï¼Œæ‰§è¡Œç½‘ç»œè¯·æ±‚</li><li>Dispatchers.Unconfinedã€‚å¯¹æ‰§è¡Œåç¨‹çš„çº¿ç¨‹ä¸åšé™åˆ¶ï¼Œå¯ä»¥ç›´æ¥åœ¨å½“å‰è°ƒåº¦å™¨æ‰€åœ¨çº¿ç¨‹ä¸Šæ‰§è¡Œ</li><li>Dispatchers.Mainã€‚ä½¿ç”¨æ­¤è°ƒåº¦ç¨‹åºå¯ç”¨äºåœ¨ Android ä¸»çº¿ç¨‹ä¸Šè¿è¡Œåç¨‹ï¼Œåªèƒ½ç”¨äºä¸ç•Œé¢äº¤äº’å’Œæ‰§è¡Œå¿«é€Ÿå·¥ä½œï¼Œä¾‹å¦‚ï¼šæ›´æ–° UIã€è°ƒç”¨ <code>LiveData.setValue</code></li></ul><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking<span class="token operator">&lt;</span>Unit<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    launch <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main runBlocking&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Default<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Default&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Unconfined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Unconfined 1&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;IO&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Unconfined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Unconfined 2&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">launch</span><span class="token punctuation">(</span><span class="token function">newSingleThreadContext</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;MyOwnThread&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;newSingleThreadContext&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Unconfined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Unconfined 4&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Unconfined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Unconfined 3&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;GlobalScope&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> Default
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> IO
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> Unconfined <span class="token number">1</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> Unconfined <span class="token number">2</span>
<span class="token punctuation">[</span>MyOwnThread<span class="token punctuation">]</span> newSingleThreadContext
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Unconfined <span class="token number">3</span>
<span class="token punctuation">[</span>MyOwnThread<span class="token punctuation">]</span> Unconfined <span class="token number">4</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> GlobalScope
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main runBlocking
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>launch</code> åœ¨ä¸æ‰§è¡Œ Dispatchers çš„æƒ…å†µä¸‹ä½¿ç”¨æ—¶ï¼Œå®ƒä»å¤–éƒ¨çš„åç¨‹ä½œç”¨åŸŸç»§æ‰¿ä¸Šä¸‹æ–‡å’Œè°ƒåº¦å™¨ï¼Œå³å’Œ runBlocking ä¿æŒä¸€è‡´ï¼Œå‡åœ¨ main çº¿ç¨‹æ‰§è¡Œ</li><li>IO å’Œ Default å‡ä¾é åå°çº¿ç¨‹æ± æ¥æ‰§è¡Œ</li><li>Unconfined åˆ™ä¸é™å®šå…·ä½“çš„çº¿ç¨‹ç±»å‹ï¼Œå½“å‰è°ƒåº¦å™¨åœ¨å“ªä¸ªçº¿ç¨‹ï¼Œå°±åœ¨è¯¥çº¿ç¨‹ä¸Šè¿›è¡Œæ‰§è¡Œï¼Œå› æ­¤ä¸Šè¿°ä¾‹å­ä¸­æ¯ä¸ª Unconfined åç¨‹æ‰€åœ¨çº¿ç¨‹å‡ä¸ä¸€æ ·</li><li>GlobalScope å¯åŠ¨åç¨‹æ—¶é»˜è®¤ä½¿ç”¨çš„è°ƒåº¦å™¨æ˜¯ Dispatchers.Defaultï¼Œå› æ­¤ä¹Ÿæ˜¯åœ¨åå°çº¿ç¨‹æ± ä¸­æ‰§è¡Œ</li><li><code>newSingleThreadContext</code> ç”¨äºä¸ºåç¨‹ä¸“é—¨åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä¸“ç”¨çº¿ç¨‹æ˜¯ä¸€ç§æˆæœ¬éå¸¸æ˜‚è´µçš„èµ„æºï¼Œåœ¨å®é™…å¼€å‘æ—¶å¿…é¡»å½“ä¸å†éœ€è¦æ—¶é‡Šæ”¾æ‰çº¿ç¨‹èµ„æºï¼Œæˆ–è€…å­˜å‚¨åœ¨é¡¶çº§å˜é‡ä¸­ä»¥ä¾¿åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è¿›è¡Œå¤ç”¨</li></ul><h2 id="_3ã€withcontext" tabindex="-1"><a class="header-anchor" href="#_3ã€withcontext" aria-hidden="true">#</a> 3ã€withContext</h2><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œ<code>get</code>æ–¹æ³•å†…ä½¿ç”¨<code>withContext(Dispatchers.IO)</code> åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å®šåœ¨ IO çº¿ç¨‹æ± ä¸­è¿è¡Œçš„ä»£ç å—ï¼Œè¯¥åŒºé—´å†…çš„ä»»ä½•ä»£ç éƒ½å§‹ç»ˆé€šè¿‡ IO çº¿ç¨‹æ¥æ‰§è¡Œã€‚ç”±äº <code>withContext</code> æ–¹æ³•æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå› æ­¤ <code>get</code> æ–¹æ³•ä¹Ÿå¿…é¡»å®šä¹‰ä¸ºæŒ‚èµ·å‡½æ•°</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">fetchDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                      <span class="token comment">// Dispatchers.Main</span>
    <span class="token keyword">val</span> result <span class="token operator">=</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;developer.android.com&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment">// Dispatchers.Main</span>
    <span class="token function">show</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                               <span class="token comment">// Dispatchers.Main</span>
<span class="token punctuation">}</span>

<span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">=</span>                 <span class="token comment">// Dispatchers.Main</span>
    <span class="token function">withContext</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token comment">// Dispatchers.IO (main-safety block)</span>
        <span class="token comment">/* perform network IO here */</span>          <span class="token comment">// Dispatchers.IO (main-safety block)</span>
    <span class="token punctuation">}</span>                                          <span class="token comment">// Dispatchers.Main</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å€ŸåŠ©åç¨‹ï¼Œä½ å¯ä»¥ç»†ç²’åº¦åœ°æ¥è°ƒåº¦çº¿ç¨‹ã€‚ç”±äº<code>withContext()</code>æ”¯æŒåœ¨ä¸å¼•å…¥å›è°ƒçš„æƒ…å†µä¸‹æ§åˆ¶ä»»ä½•ä»£ç çš„æ‰§è¡Œçº¿ç¨‹æ± ï¼Œå› æ­¤ä½ å¯ä»¥å°†å…¶åº”ç”¨äºéå¸¸å°çš„å‡½æ•°ï¼Œä¾‹å¦‚ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®æˆ–æ‰§è¡Œç½‘ç»œè¯·æ±‚ã€‚ä¸€ç§ä¸é”™çš„åšæ³•æ˜¯ä½¿ç”¨ <code>withContext()</code> æ¥ç¡®ä¿æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸»çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€ï¼Œä½ å¯ä»¥ä»ä¸»çº¿ç¨‹è°ƒç”¨æ¯ä¸ªå‡½æ•°ã€‚è¿™æ ·ï¼Œè°ƒç”¨æ–¹å°±ä»ä¸éœ€è¦è€ƒè™‘åº”è¯¥ä½¿ç”¨å“ªä¸ªçº¿ç¨‹æ¥æ‰§è¡Œå‡½æ•°äº†</p><p>åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>fetchDocs()</code> æ–¹æ³•åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä¸è¿‡å®ƒå¯ä»¥å®‰å…¨åœ°è°ƒç”¨ <code>get</code>æ–¹æ³•ï¼Œå› ä¸º<code>get</code>æ–¹æ³•å·²ç¡®ä¿ç½‘ç»œè¯·æ±‚ä¼šåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ç”±äºåç¨‹æ”¯æŒ <code>suspend</code> å’Œ <code>resume</code>æ“ä½œï¼Œå› æ­¤ <code>withContext</code> å—å®Œæˆåï¼Œä¸»çº¿ç¨‹ä¸Šçš„åç¨‹ä¼šç«‹å³æ ¹æ® <code>get</code> ç»“æœæ¢å¤</p><p>ä¸åŸºäºå›è°ƒçš„ç­‰æ•ˆå®ç°ç›¸æ¯”ï¼Œ<code>withContext()</code> ä¸ä¼šå¢åŠ é¢å¤–çš„å¼€é”€ã€‚æ­¤å¤–ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥ä¼˜åŒ– <code>withContext()</code> è°ƒç”¨ï¼Œä½¿å…¶è¶…è¶ŠåŸºäºå›è°ƒçš„ç­‰æ•ˆå®ç°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªå‡½æ•°éœ€è¦å…ˆåè°ƒç”¨åæ¬¡ç½‘ç»œè¯·æ±‚ï¼Œä½ å¯ä»¥åœ¨æœ€å¤–å±‚è°ƒç”¨ <code>withContext()</code> è®©åç¨‹åªåˆ‡æ¢ä¸€æ¬¡çº¿ç¨‹ï¼Œè¿™æ ·å³ä½¿æ¯ä¸ªç½‘ç»œè¯·æ±‚å†…éƒ¨å‡ä¼šä½¿ç”¨ <code>withContext()</code>ï¼Œå®ƒä¹Ÿä¼šç•™åœ¨åŒä¸€è°ƒåº¦ç¨‹åºä¸Šï¼Œä»è€Œé¿å…é¢‘ç‡åˆ‡æ¢çº¿ç¨‹ã€‚æ­¤å¤–ï¼Œåç¨‹è¿˜ä¼˜åŒ–äº† <code>Dispatchers.Default</code> ä¸ <code>Dispatchers.IO</code> ä¹‹é—´çš„åˆ‡æ¢ï¼Œä»¥å°½å¯èƒ½é¿å…çº¿ç¨‹åˆ‡æ¢</p><blockquote><p>ä½¿ç”¨çº¿ç¨‹æ± çš„è°ƒåº¦å™¨ï¼ˆä¾‹å¦‚ <code>Dispatchers.IO</code> æˆ– <code>Dispatchers.Default</code>ï¼‰ä¸èƒ½ä¿è¯ä»£ç å—ä¸€ç›´åœ¨åŒä¸€çº¿ç¨‹ä¸Šä»ä¸Šåˆ°ä¸‹æ‰§è¡Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåç¨‹åœ¨ <code>suspend</code> å’Œ <code>resume</code> åå¯èƒ½ä¼šå°†ä»»åŠ¡ç§»äº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºæ•´ä¸ª <code>withContext()</code> å—ï¼Œç”±äºå¤šçº¿ç¨‹å¹¶å‘ä¹‹é—´çš„<strong>åŸå­æ€§</strong>å’Œ<strong>å¯è§æ€§</strong>ç­‰åŸå› ï¼Œå…ˆåè¯»å–åˆ°çš„çº¿ç¨‹å±€éƒ¨å˜é‡å¯èƒ½å¹¶éæ˜¯åŒä¸ªå€¼</p></blockquote><h2 id="_4ã€coroutinename" tabindex="-1"><a class="header-anchor" href="#_4ã€coroutinename" aria-hidden="true">#</a> 4ã€CoroutineName</h2><p>CoroutineName ç”¨äºä¸ºåç¨‹æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œå®šä½é—®é¢˜</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking<span class="token operator">&lt;</span>Unit<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">CoroutineName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;RunBlocking&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;start&quot;</span></span><span class="token punctuation">)</span>
    <span class="token function">launch</span><span class="token punctuation">(</span><span class="token function">CoroutineName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;MainCoroutine&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">launch</span><span class="token punctuation">(</span><span class="token function">CoroutineName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Coroutine#A&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launch A&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">launch</span><span class="token punctuation">(</span><span class="token function">CoroutineName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Coroutine#B&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launch B&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€coroutineexceptionhandler" tabindex="-1"><a class="header-anchor" href="#_5ã€coroutineexceptionhandler" aria-hidden="true">#</a> 5ã€CoroutineExceptionHandler</h2><p>åœ¨ä¸‹æ–‡çš„å¼‚å¸¸å¤„ç†ä¼šè®²åˆ°</p><h2 id="_6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ " tabindex="-1"><a class="header-anchor" href="#_6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ " aria-hidden="true">#</a> 6ã€ç»„åˆä¸Šä¸‹æ–‡å…ƒç´ </h2><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¸ºåç¨‹ä¸Šä¸‹æ–‡å®šä¹‰å¤šä¸ªå…ƒç´ ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨ <code>+</code> è¿ç®—ç¬¦ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶ä¸ºåç¨‹æŒ‡å®š Dispatcher å’Œ CoroutineName</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking<span class="token operator">&lt;</span>Unit<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Default <span class="token operator">+</span> <span class="token function">CoroutineName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;test&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Hello World&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œç”±äº CoroutineContext æ˜¯ç”±ä¸€ç»„å…ƒç´ ç»„æˆçš„ï¼Œæ‰€ä»¥åŠ å·å³ä¾§çš„å…ƒç´ ä¼šè¦†ç›–åŠ å·å·¦ä¾§çš„å…ƒç´ ï¼Œä»è€Œç»„æˆæ–°çš„ CoroutineContextã€‚æ¯”å¦‚ï¼Œ<code>(Dispatchers.Main, &quot;name&quot;) + (Dispatchers.IO)</code> çš„è¿è¡Œç»“æœæ˜¯ï¼š<code>(Dispatchers.IO, &quot;name&quot;)</code></p><h1 id="å…«ã€å–æ¶ˆåç¨‹" tabindex="-1"><a class="header-anchor" href="#å…«ã€å–æ¶ˆåç¨‹" aria-hidden="true">#</a> å…«ã€å–æ¶ˆåç¨‹</h1><p>å¦‚æœç”¨æˆ·é€€å‡ºå¯åŠ¨äº†åç¨‹çš„ Activity / Fragmentï¼Œé‚£æ­£å¸¸æƒ…å†µä¸‹å°±åº”è¯¥å–æ¶ˆæ‰€æœ‰åç¨‹</p><p><code>job.cancel()</code>å°±ç”¨äºå–æ¶ˆåç¨‹ï¼Œ<code>job.join()</code>ç”¨äºé˜»å¡ç­‰å¾…åç¨‹è¿è¡Œç»“æŸã€‚å› ä¸º <code>cancel()</code> å‡½æ•°è°ƒç”¨åä¼šé©¬ä¸Šè¿”å›è€Œä¸æ˜¯ç­‰å¾…åç¨‹ç»“æŸåå†è¿”å›ï¼Œæ‰€ä»¥æ­¤æ—¶åç¨‹ä¸ä¸€å®šå°±æ˜¯å·²ç»åœæ­¢è¿è¡Œäº†ã€‚å¦‚æœéœ€è¦ç¡®ä¿åç¨‹ç»“æŸè¿è¡Œåå†æ‰§è¡Œåç»­ä»£ç ï¼Œå°±éœ€è¦è°ƒç”¨ <code>join()</code> æ–¹æ³•æ¥é˜»å¡ç­‰å¾…ã€‚ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ Job çš„æ‰©å±•å‡½æ•° <code>cancelAndJoin()</code> æ¥å®Œæˆç›¸åŒæ“ä½œï¼Œå®ƒç»“åˆäº† <code>cancel</code> å’Œ <code>join</code>ä¸¤ä¸ªæ“ä½œ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> i <span class="token operator">-&gt;</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job: I&#39;m sleeping </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">i</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500L</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1300L</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: I&#39;m tired of waiting!&quot;</span></span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: Now I can quit.&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">1</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">2</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> I&#39;m tired of waiting<span class="token operator">!</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> Now I can quit<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ" tabindex="-1"><a class="header-anchor" href="#_1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ" aria-hidden="true">#</a> 1ã€åç¨‹å¯èƒ½æ— æ³•å–æ¶ˆ</h2><p>å¹¶ä¸æ˜¯æ‰€æœ‰åç¨‹éƒ½å¯ä»¥å“åº”å–æ¶ˆæ“ä½œï¼Œåç¨‹çš„å–æ¶ˆæ“ä½œæ˜¯éœ€è¦åä½œ (cooperative) å®Œæˆçš„ï¼Œ<strong>åç¨‹å¿…é¡»åä½œæ‰èƒ½è¢«å–æ¶ˆ</strong>ã€‚åç¨‹åº“ä¸­çš„æ‰€æœ‰æŒ‚èµ·å‡½æ•°éƒ½æ˜¯å¯å–æ¶ˆçš„ï¼Œå®ƒä»¬åœ¨è¿è¡Œå‰æ£€æŸ¥åç¨‹æ˜¯å¦è¢«å–æ¶ˆäº†ï¼Œå¹¶åœ¨å–æ¶ˆæ—¶æŠ›å‡º CancellationException ä»è€Œç»“æŸæ•´ä¸ªä»»åŠ¡ã€‚è€Œå¦‚æœåç¨‹åœ¨æ‰§è¡Œè®¡ç®—ä»»åŠ¡å‰æ²¡æœ‰åˆ¤æ–­è‡ªèº«æ˜¯å¦å·²è¢«å–æ¶ˆçš„è¯ï¼Œæ­¤æ—¶å°±æ— æ³•å–æ¶ˆåç¨‹</p><p>æ‰€ä»¥å³ä½¿ä»¥ä¸‹ä»£ç ä¸»åŠ¨å–æ¶ˆäº†åç¨‹ï¼Œåç¨‹ä¹Ÿåªä¼šåœ¨å®Œæˆæ—¢å®šå¾ªç¯åæ‰ç»“æŸè¿è¡Œï¼Œå› ä¸ºåç¨‹æ²¡æœ‰åœ¨æ¯æ¬¡å¾ªç¯å‰å…ˆè¿›è¡Œæ£€æŸ¥ï¼Œå¯¼è‡´ä»»åŠ¡ä¸å—å–æ¶ˆæ“ä½œçš„å½±å“</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Default<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> nextPrintTime <span class="token operator">=</span> startTime
        <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> nextPrintTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job: I&#39;m sleeping </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">i<span class="token operator">++</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span>
                nextPrintTime <span class="token operator">+=</span> <span class="token number">500L</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1300L</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: I&#39;m tired of waiting!&quot;</span></span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">cancelAndJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: Now I can quit.&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">1</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">2</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> I&#39;m tired of waiting<span class="token operator">!</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">3</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">4</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> Now I can quit<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºäº†å®ç°å–æ¶ˆåç¨‹çš„ç›®çš„ï¼Œå°±éœ€è¦ä¸ºä¸Šè¿°ä»£ç åŠ ä¸Šåˆ¤æ–­åç¨‹æ˜¯å¦è¿˜å¤„äºå¯è¿è¡ŒçŠ¶æ€çš„é€»è¾‘ï¼Œå½“ä¸å¯è¿è¡Œæ—¶å°±ä¸»åŠ¨é€€å‡ºåç¨‹ã€‚<code>isActive</code> æ˜¯ CoroutineScope çš„æ‰©å±•å±æ€§ï¼Œå°±ç”¨äºåˆ¤æ–­åç¨‹æ˜¯å¦è¿˜å¤„äºå¯è¿è¡ŒçŠ¶æ€</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> <span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Default<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> nextPrintTime <span class="token operator">=</span> startTime
        <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isActive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> nextPrintTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job: I&#39;m sleeping </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">i<span class="token operator">++</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span>
                    nextPrintTime <span class="token operator">+=</span> <span class="token number">500L</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token label symbol">@launch</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1300L</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: I&#39;m tired of waiting!&quot;</span></span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">cancelAndJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: Now I can quit.&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å–æ¶ˆåç¨‹è¿™ä¸ªæ“ä½œç±»ä¼¼äºåœ¨ Java ä¸­è°ƒç”¨<code>Thread.interrupt()</code>æ–¹æ³•æ¥å‘çº¿ç¨‹å‘èµ·ä¸­æ–­è¯·æ±‚ï¼Œè¿™ä¸¤ä¸ªæ“ä½œéƒ½ä¸ä¼šå¼ºåˆ¶åœæ­¢åç¨‹å’Œçº¿ç¨‹ï¼Œå¤–éƒ¨åªæ˜¯ç›¸å½“äºå‘èµ·ä¸€ä¸ªåœæ­¢è¿è¡Œçš„è¯·æ±‚ï¼Œéœ€è¦ä¾é åç¨‹å’Œçº¿ç¨‹å“åº”è¯·æ±‚åä¸»åŠ¨åœæ­¢è¿è¡Œ</p><p>Java å’Œ Kotlin ä¹‹æ‰€ä»¥å‡æ²¡æœ‰æä¾›ä¸€ä¸ªå¯ä»¥ç›´æ¥å¼ºåˆ¶åœæ­¢çº¿ç¨‹æˆ–åç¨‹çš„æ–¹æ³•ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªæ“ä½œå¯èƒ½ä¼šå¸¦æ¥å„ç§æ„æƒ³ä¸åˆ°çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œåœ¨åœæ­¢çº¿ç¨‹æˆ–åç¨‹çš„æ—¶å€™ï¼Œå®ƒä»¬å¯èƒ½è¿˜æŒæœ‰ç€æŸäº›æ’ä»–æ€§èµ„æºï¼ˆä¾‹å¦‚ï¼šé”ï¼Œæ•°æ®åº“é“¾æ¥ï¼‰ï¼Œå¦‚æœå¼ºåˆ¶æ€§åœ°åœæ­¢ï¼Œå®ƒä»¬æŒæœ‰çš„é”å°±ä¼šä¸€ç›´æ— æ³•å¾—åˆ°é‡Šæ”¾ï¼Œå¯¼è‡´å…¶å®ƒçº¿ç¨‹æˆ–åç¨‹ä¸€ç›´æ— æ³•å¾—åˆ°ç›®æ ‡èµ„æºï¼Œæœ€ç»ˆå°±å¯èƒ½å¯¼è‡´çº¿ç¨‹æ­»é”ã€‚æ‰€ä»¥<code>Thread.stop()</code>æ–¹æ³•ç›®å‰ä¹Ÿæ˜¯å¤„äºåºŸå¼ƒçŠ¶æ€ï¼ŒJava å®˜æ–¹å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªå¯é çš„åœæ­¢çº¿ç¨‹çš„æ–¹æ³•</p><h2 id="_2ã€ç”¨-finally-é‡Šæ”¾èµ„æº" tabindex="-1"><a class="header-anchor" href="#_2ã€ç”¨-finally-é‡Šæ”¾èµ„æº" aria-hidden="true">#</a> 2ã€ç”¨ finally é‡Šæ”¾èµ„æº</h2><p>å¯å–æ¶ˆçš„æŒ‚èµ·å‡½æ•°åœ¨å–æ¶ˆæ—¶ä¼šæŠ›å‡º CancellationExceptionï¼Œå¯ä»¥ä¾é <code>try {...} finally {...}</code> æˆ–è€… Kotlin çš„ <code>use</code> å‡½æ•°åœ¨å–æ¶ˆåç¨‹åé‡Šæ”¾æŒæœ‰çš„èµ„æº</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> i <span class="token operator">-&gt;</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job: I&#39;m sleeping </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">i</span></span><span class="token string"> ...&quot;</span></span><span class="token punctuation">)</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500L</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job: I&#39;m running finally&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1300L</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: I&#39;m tired of waiting!&quot;</span></span><span class="token punctuation">)</span>
    job<span class="token punctuation">.</span><span class="token function">cancelAndJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;main: Now I can quit.&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">0</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">1</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m sleeping <span class="token number">2</span> <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> I&#39;m tired of waiting<span class="token operator">!</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> StandaloneCoroutine was cancelled
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job<span class="token operator">:</span> I&#39;m running <span class="token keyword">finally</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> main<span class="token operator">:</span> Now I can quit<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3ã€noncancellable" tabindex="-1"><a class="header-anchor" href="#_3ã€noncancellable" aria-hidden="true">#</a> 3ã€NonCancellable</h2><p>å¦‚æœåœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­çš„ <code>finally</code> å—ä¸­å†è°ƒç”¨æŒ‚èµ·å‡½æ•°çš„è¯ï¼Œå°†ä¼šå¯¼è‡´æŠ›å‡º CancellationExceptionï¼Œå› ä¸ºæ­¤æ—¶åç¨‹å·²ç»è¢«å–æ¶ˆäº†ã€‚é€šå¸¸æˆ‘ä»¬å¹¶ä¸ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œå› ä¸ºå¸¸è§çš„èµ„æºé‡Šæ”¾æ“ä½œéƒ½æ˜¯éé˜»å¡çš„ï¼Œä¸”ä¸æ¶‰åŠä»»ä½•æŒ‚èµ·å‡½æ•°ã€‚ä½†åœ¨æå°‘æ•°æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦åœ¨å–æ¶ˆçš„åç¨‹ä¸­å†è°ƒç”¨æŒ‚èµ·å‡½æ•°ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ <code>withContext</code> å‡½æ•°å’Œ <code>NonCancellable</code>ä¸Šä¸‹æ–‡å°†ç›¸åº”çš„ä»£ç åŒ…è£…åœ¨ <code>withContext(NonCancellable) {...}</code> ä»£ç å—ä¸­ï¼ŒNonCancellable å°±ç”¨äºåˆ›å»ºä¸€ä¸ªæ— æ³•å–æ¶ˆçš„åç¨‹ä½œç”¨åŸŸ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;start&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> launchA <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchA-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchA isCompleted&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> launchB <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchB-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token function">withContext</span><span class="token punctuation">(</span>NonCancellable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;launchB isCompleted&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//å»¶æ—¶ä¸€ç™¾æ¯«ç§’ï¼Œä¿è¯ä¸¤ä¸ªåç¨‹éƒ½å·²ç»è¢«å¯åŠ¨äº†</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    launchA<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    launchB<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> start
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA<span class="token operator">-</span><span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB<span class="token operator">-</span><span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA<span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB<span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchA<span class="token operator">-</span><span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB<span class="token operator">-</span><span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> end
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> launchB isCompleted
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4ã€çˆ¶åç¨‹å’Œå­åç¨‹" tabindex="-1"><a class="header-anchor" href="#_4ã€çˆ¶åç¨‹å’Œå­åç¨‹" aria-hidden="true">#</a> 4ã€çˆ¶åç¨‹å’Œå­åç¨‹</h2><p>å½“ä¸€ä¸ªåç¨‹åœ¨å¦å¤–ä¸€ä¸ªåç¨‹çš„åç¨‹ä½œç”¨åŸŸä¸­å¯åŠ¨æ—¶ï¼Œå®ƒå°†é€šè¿‡ <code>CoroutineScope.coroutineContext</code> ç»§æ‰¿å…¶ä¸Šä¸‹æ–‡ï¼Œæ–°å¯åŠ¨çš„åç¨‹å°±è¢«ç§°ä¸ºå­åç¨‹ï¼Œå­åç¨‹çš„ Job å°†æˆä¸ºçˆ¶åç¨‹ Job çš„å­ Jobã€‚çˆ¶åç¨‹æ€»æ˜¯ä¼šç­‰å¾…å…¶æ‰€æœ‰å­åç¨‹éƒ½å®Œæˆåæ‰ç»“æŸè‡ªèº«ï¼Œæ‰€ä»¥çˆ¶åç¨‹ä¸å¿…æ˜¾å¼è·Ÿè¸ªå®ƒå¯åŠ¨çš„æ‰€æœ‰å­åç¨‹ï¼Œä¹Ÿä¸å¿…ä½¿ç”¨ <code>Job.join</code> åœ¨æœ«å°¾ç­‰å¾…å­åç¨‹å®Œæˆ</p><p>æ‰€ä»¥è™½ç„¶ parentJob å¯åŠ¨çš„ä¸‰ä¸ªå­åç¨‹çš„å»¶æ—¶æ—¶é—´å„ä¸ç›¸åŒï¼Œä½†å®ƒä»¬æœ€ç»ˆéƒ½ä¼šæ‰“å°å‡ºæ—¥å¿—</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> parentJob <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> i <span class="token operator">-&gt;</span>
            launch <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200L</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Coroutine </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">i</span></span><span class="token string"> is done&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;request: I&#39;m done and I don&#39;t explicitly join my children that are still active&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> request<span class="token operator">:</span> I&#39;m done <span class="token operator">and</span> I don&#39;t explicitly join my children that are still active
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Coroutine <span class="token number">0</span> <span class="token keyword">is</span> done
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Coroutine <span class="token number">1</span> <span class="token keyword">is</span> done
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Coroutine <span class="token number">2</span> <span class="token keyword">is</span> done
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ" aria-hidden="true">#</a> 5ã€ä¼ æ’­å–æ¶ˆæ“ä½œ</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåç¨‹çš„å–æ¶ˆæ“ä½œä¼šé€šè¿‡åç¨‹çš„å±‚æ¬¡ç»“æ„æ¥è¿›è¡Œä¼ æ’­ï¼šå¦‚æœå–æ¶ˆçˆ¶åç¨‹æˆ–è€…çˆ¶åç¨‹æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆå­åç¨‹éƒ½ä¼šè¢«å–æ¶ˆï¼›è€Œå¦‚æœå­åç¨‹è¢«å–æ¶ˆï¼Œåˆ™ä¸ä¼šå½±å“åŒçº§åç¨‹å’Œçˆ¶åç¨‹ï¼Œä½†å¦‚æœå­åç¨‹æŠ›å‡ºå¼‚å¸¸åˆ™ä¹Ÿä¼šå¯¼è‡´åŒçº§åç¨‹å’Œçˆ¶åç¨‹è¢«å–æ¶ˆ</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œå­åç¨‹ jon1 è¢«å–æ¶ˆå¹¶ä¸å½±å“å­åç¨‹ jon2 å’Œçˆ¶åç¨‹ç»§ç»­è¿è¡Œï¼Œä½†çˆ¶åç¨‹è¢«å–æ¶ˆåå­åç¨‹éƒ½ä¼šè¢«é€’å½’å–æ¶ˆ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> request <span class="token operator">=</span> launch <span class="token punctuation">{</span>
        <span class="token keyword">val</span> job1 <span class="token operator">=</span> launch <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job1: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job1 canceled&quot;</span></span><span class="token punctuation">)</span>
                    <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">val</span> job2 <span class="token operator">=</span> launch <span class="token punctuation">{</span>
            <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;job2: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1600</span><span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;parent job canceled&quot;</span></span><span class="token punctuation">)</span>
    request<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> job1<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job2<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job1<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job2<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job1<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job1 canceled
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job2<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job2<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> job2<span class="token operator">:</span> <span class="token number">4</span>
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> parent job canceled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6ã€withtimeout" tabindex="-1"><a class="header-anchor" href="#_6ã€withtimeout" aria-hidden="true">#</a> 6ã€withTimeout</h2><p><code>withTimeout</code> å‡½æ•°ç”¨äºæŒ‡å®šåç¨‹çš„è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…æ—¶åˆ™ä¼šæŠ›å‡º TimeoutCancellationExceptionï¼Œä»è€Œä»¤åç¨‹ç»“æŸè¿è¡Œ</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;start&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> result <span class="token operator">=</span> <span class="token function">withTimeout</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token number">200</span>
    <span class="token punctuation">}</span>
    <span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;end&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> start
Exception <span class="token keyword">in</span> thread <span class="token string-literal singleline"><span class="token string">&quot;main&quot;</span></span> kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>TimeoutCancellationException<span class="token operator">:</span> Timed <span class="token keyword">out</span> waiting <span class="token keyword">for</span> <span class="token number">300</span> ms
	at kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>TimeoutKt<span class="token punctuation">.</span><span class="token function">TimeoutCancellationException</span><span class="token punctuation">(</span>Timeout<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">186</span><span class="token punctuation">)</span>
	at kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>TimeoutCoroutine<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Timeout<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">156</span><span class="token punctuation">)</span>
	at kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>EventLoopImplBase$DelayedRunnableTask<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>EventLoop<span class="token punctuation">.</span>common<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">497</span><span class="token punctuation">)</span>
	at kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>EventLoopImplBase<span class="token punctuation">.</span><span class="token function">processNextEvent</span><span class="token punctuation">(</span>EventLoop<span class="token punctuation">.</span>common<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">274</span><span class="token punctuation">)</span>
	at kotlinx<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span>DefaultExecutor<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>DefaultExecutor<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">69</span><span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">748</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>withTimeout</code>æ–¹æ³•æŠ›å‡ºçš„ TimeoutCancellationException æ˜¯ CancellationException çš„å­ç±»ï¼Œä¹‹å‰æˆ‘ä»¬å¹¶æœªåœ¨è¾“å‡ºæ—¥å¿—ä¸Šçœ‹åˆ°å…³äº CancellationException è¿™ç±»å¼‚å¸¸çš„å †æ ˆä¿¡æ¯ï¼Œè¿™æ˜¯å› ä¸ºå¯¹äºä¸€ä¸ªå·²å–æ¶ˆçš„åç¨‹æ¥è¯´ï¼ŒCancellationException è¢«è®¤ä¸ºæ˜¯è§¦å‘åç¨‹ç»“æŸçš„æ­£å¸¸åŸå› ã€‚ä½†å¯¹äº<code>withTimeout</code>æ–¹æ³•æ¥è¯´ï¼ŒæŠ›å‡ºå¼‚å¸¸æ˜¯å…¶ä¸ŠæŠ¥è¶…æ—¶æƒ…å†µçš„ä¸€ç§æ‰‹æ®µï¼Œæ‰€ä»¥è¯¥å¼‚å¸¸ä¸ä¼šè¢«åç¨‹å†…éƒ¨æ¶ˆåŒ–æ‰</p><p>å¦‚æœä¸å¸Œæœ›å› ä¸ºå¼‚å¸¸å¯¼è‡´åç¨‹ç»“æŸï¼Œå¯ä»¥æ”¹ç”¨<code>withTimeoutOrNull</code>æ–¹æ³•ï¼Œå¦‚æœè¶…æ—¶å°±ä¼šè¿”å› null</p><h1 id="ä¹ã€å¼‚å¸¸å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ä¹ã€å¼‚å¸¸å¤„ç†" aria-hidden="true">#</a> ä¹ã€å¼‚å¸¸å¤„ç†</h1><p>å½“ä¸€ä¸ªåç¨‹ç”±äºå¼‚å¸¸è€Œè¿è¡Œå¤±è´¥æ—¶ï¼Œå®ƒä¼šä¼ æ’­è¿™ä¸ªå¼‚å¸¸å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶åç¨‹ã€‚æ¥ä¸‹æ¥ï¼Œçˆ¶åç¨‹ä¼šè¿›è¡Œä¸‹é¢å‡ æ­¥æ“ä½œï¼š</p><ul><li>å–æ¶ˆå®ƒè‡ªå·±çš„å­çº§</li><li>å–æ¶ˆå®ƒè‡ªå·±</li><li>å°†å¼‚å¸¸ä¼ æ’­å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶çº§</li></ul><p>å¼‚å¸¸ä¼šåˆ°è¾¾å±‚çº§çš„æ ¹éƒ¨ï¼Œä¸”å½“å‰ CoroutineScope æ‰€å¯åŠ¨çš„æ‰€æœ‰åç¨‹éƒ½ä¼šè¢«å–æ¶ˆï¼Œä½†åç¨‹å¹¶ééƒ½æ˜¯ä¸€å‘ç°å¼‚å¸¸å°±æ‰§è¡Œä»¥ä¸Šæµç¨‹ï¼Œlaunch å’Œ async åœ¨å¤„ç†å¼‚å¸¸æ–¹é¢æœ‰ç€ä¸€äº›å·®å¼‚</p><p>launch å°†å¼‚å¸¸è§†ä¸ºæœªæ•è·å¼‚å¸¸ï¼Œç±»ä¼¼äº Java çš„ <code>Thread.uncaughtExceptionHandler</code>ï¼Œå½“å‘ç°å¼‚å¸¸æ—¶å°±ä¼šé©¬ä¸ŠæŠ›å‡ºã€‚async æœŸæœ›æœ€ç»ˆé€šè¿‡è°ƒç”¨ await æ¥è·å–ç»“æœ (æˆ–è€…å¼‚å¸¸)ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹å®ƒä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿™æ„å‘³ç€å¦‚æœä½¿ç”¨ async å¯åŠ¨æ–°çš„åç¨‹ï¼Œå®ƒä¼šé™é»˜åœ°å°†å¼‚å¸¸ä¸¢å¼ƒï¼Œç›´åˆ°è°ƒç”¨ <code>async.await()</code> æ‰ä¼šå¾—åˆ°ç›®æ ‡å€¼æˆ–è€…æŠ›å‡ºå­˜åœ¨çš„å¼‚å¸¸</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹çš„ <code>fetchDocs()</code> æ–¹æ³•ç”±äºå¹¶æ²¡æœ‰è°ƒç”¨ <code>Deferred.await()</code>ï¼Œå› æ­¤å¼‚å¸¸å¹¶ä¸ä¼šè¢«æŠ›ç»™è°ƒç”¨æ–¹ï¼Œè€Œå¦‚æœä½¿ç”¨çš„æ˜¯ launch è€Œé async çš„è¯ï¼Œå¼‚å¸¸å°±ä¼šé©¬ä¸Šè¢«æŠ›å‡º</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">private</span> <span class="token keyword">val</span> ioScope <span class="token operator">=</span> <span class="token function">CoroutineScope</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span>

<span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">fetchDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ioScope<span class="token punctuation">.</span><span class="token function">async</span> <span class="token punctuation">{</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;taskA throw AssertionError&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token function">AssertionError</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1ã€coroutineexceptionhandler" tabindex="-1"><a class="header-anchor" href="#_1ã€coroutineexceptionhandler" aria-hidden="true">#</a> 1ã€CoroutineExceptionHandler</h2><p>å¦‚æœæƒ³ä¸»åŠ¨æ•è·å¼‚å¸¸ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ CoroutineExceptionHandler ä½œä¸ºåç¨‹çš„ä¸Šä¸‹æ–‡å…ƒç´ ä¹‹ä¸€ï¼Œåœ¨è¿™é‡Œè¿›è¡Œè‡ªå®šä¹‰æ—¥å¿—è®°å½•æˆ–å¼‚å¸¸å¤„ç†ï¼Œå®ƒç±»ä¼¼äºå¯¹çº¿ç¨‹ä½¿ç”¨ <code>Thread.uncaughtExceptionHandler</code>ã€‚ä½†æ˜¯ï¼ŒCoroutineExceptionHandler åªä¼šåœ¨é¢„è®¡ä¸ä¼šç”±ç”¨æˆ·å¤„ç†çš„å¼‚å¸¸ä¸Šè°ƒç”¨ï¼Œå› æ­¤åœ¨ async ä¸­ä½¿ç”¨å®ƒæ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œå½“ async å†…éƒ¨å‘ç”Ÿäº†å¼‚å¸¸ä¸”æ²¡æœ‰æ•è·æ—¶ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>async.await()</code> ä¾ç„¶ä¼šå¯¼è‡´åº”ç”¨å´©æºƒ</p><p>ä»¥ä¸‹ä»£ç åªä¼šæ•è·åˆ° launch æŠ›å‡ºçš„å¼‚å¸¸</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> handler <span class="token operator">=</span> CoroutineExceptionHandler <span class="token punctuation">{</span> _<span class="token punctuation">,</span> exception <span class="token operator">-&gt;</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Caught </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">exception</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> job <span class="token operator">=</span> GlobalScope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token function">AssertionError</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">val</span> deferred <span class="token operator">=</span> GlobalScope<span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token function">ArithmeticException</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">joinAll</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> deferred<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>DefaultDispatcher<span class="token operator">-</span>worker<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> Caught java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>AssertionError
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_2ã€supervisorjob" tabindex="-1"><a class="header-anchor" href="#_2ã€supervisorjob" aria-hidden="true">#</a> 2ã€SupervisorJob</h2><p>ç”±äºå¼‚å¸¸å¯¼è‡´çš„å–æ¶ˆåœ¨åç¨‹ä¸­æ˜¯ä¸€ç§åŒå‘å…³ç³»ï¼Œä¼šåœ¨æ•´ä¸ªåç¨‹å±‚æ¬¡ç»“æ„ä¸­ä¼ æ’­ï¼Œé‚£å¦‚æœæˆ‘ä»¬éœ€è¦çš„æ˜¯<strong>å•å‘å–æ¶ˆ</strong>è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p><p>ä¾‹å¦‚ï¼Œå‡è®¾åœ¨ Activity ä¸­å¯åŠ¨äº†å¤šä¸ªåç¨‹ï¼Œå¦‚æœå•ä¸ªåç¨‹æ‰€ä»£è¡¨çš„å­ä»»åŠ¡å¤±è´¥äº†ï¼Œæ­¤æ—¶å¹¶ä¸ä¸€å®šéœ€è¦è¿é”ç»ˆæ­¢æ•´ä¸ª Activity å†…éƒ¨çš„æ‰€æœ‰å…¶å®ƒåç¨‹ä»»åŠ¡ï¼Œå³æ­¤æ—¶å¸Œæœ›å­åç¨‹çš„å¼‚å¸¸ä¸ä¼šä¼ æ’­ç»™åŒçº§åç¨‹å’Œçˆ¶åç¨‹ã€‚è€Œå½“ Activity é€€å‡ºåï¼Œçˆ¶åç¨‹çš„å¼‚å¸¸ï¼ˆå³ CancellationExceptionï¼‰åˆåº”è¯¥è¿é”ä¼ æ’­ç»™æ‰€æœ‰å­åç¨‹ï¼Œç»ˆæ­¢æ‰€æœ‰å­åç¨‹</p><p>å¯ä»¥ä½¿ç”¨ SupervisorJob æ¥å®ç°ä¸Šè¿°æ•ˆæœï¼Œå–æ¶ˆæ“ä½œåªä¼šå‘ä¸‹ä¼ æ’­ï¼Œä¸€ä¸ªå­åç¨‹çš„è¿è¡Œå¤±è´¥ä¸ä¼šå½±å“åˆ°åŒçº§åç¨‹å’Œçˆ¶åç¨‹</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç¤ºä¾‹ä¸­ firstChild æŠ›å‡ºçš„å¼‚å¸¸ä¸ä¼šå¯¼è‡´ secondChild è¢«å–æ¶ˆï¼Œä½†å½“ supervisor è¢«å–æ¶ˆæ—¶ secondChild ä¹Ÿè¢«åŒæ—¶å–æ¶ˆäº†</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runBlocking <span class="token punctuation">{</span>
    <span class="token keyword">val</span> supervisor <span class="token operator">=</span> <span class="token function">SupervisorJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">with</span><span class="token punctuation">(</span><span class="token function">CoroutineScope</span><span class="token punctuation">(</span>coroutineContext <span class="token operator">+</span> supervisor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> firstChild <span class="token operator">=</span> <span class="token function">launch</span><span class="token punctuation">(</span>CoroutineExceptionHandler <span class="token punctuation">{</span> _<span class="token punctuation">,</span> _ <span class="token operator">-&gt;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;First child is failing&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token function">AssertionError</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;First child is cancelled&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">val</span> secondChild <span class="token operator">=</span> launch <span class="token punctuation">{</span>
            firstChild<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;First child is cancelled: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">firstChild<span class="token punctuation">.</span>isCancelled</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, but second one is still active&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token function">delay</span><span class="token punctuation">(</span>Long<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Second child is cancelled because supervisor is cancelled&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        firstChild<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Cancelling supervisor&quot;</span></span><span class="token punctuation">)</span>
        <span class="token comment">//å–æ¶ˆæ‰€æœ‰åç¨‹</span>
        supervisor<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        secondChild<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token punctuation">[</span>main<span class="token punctuation">]</span> First child <span class="token keyword">is</span> failing
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> First child <span class="token keyword">is</span> cancelled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> but second one <span class="token keyword">is</span> still active
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Cancelling supervisor
<span class="token punctuation">[</span>main<span class="token punctuation">]</span> Second child <span class="token keyword">is</span> cancelled because supervisor <span class="token keyword">is</span> cancelled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ï¼Œå¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«å¤„ç†ä¸” CoroutineContext æ²¡æœ‰åŒ…å«ä¸€ä¸ª CoroutineExceptionHandler çš„è¯ï¼Œå¼‚å¸¸ä¼šåˆ°è¾¾é»˜è®¤çº¿ç¨‹çš„ ExceptionHandlerã€‚åœ¨ JVM ä¸­ï¼Œå¼‚å¸¸ä¼šè¢«æ‰“å°åœ¨æ§åˆ¶å°ï¼›è€Œåœ¨ Android ä¸­ï¼Œæ— è®ºå¼‚å¸¸åœ¨é‚£ä¸ª Dispatcher ä¸­å‘ç”Ÿï¼Œéƒ½ä¼šç›´æ¥å¯¼è‡´åº”ç”¨å´©æºƒã€‚æ‰€ä»¥å¦‚æœä¸Šè¿°ä¾‹å­ä¸­ç§»é™¤äº† firstChild åŒ…å«çš„ CoroutineExceptionHandler çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ Android åº”ç”¨å´©æºƒ</p><h1 id="åã€android-ktx" tabindex="-1"><a class="header-anchor" href="#åã€android-ktx" aria-hidden="true">#</a> åã€Android ktx</h1><p>Android ktx æ˜¯åŒ…å«åœ¨ Android Jetpack åŠå…¶ä»– Android åº“ä¸­çš„ä¸€ç»„ Kotlin æ‰©å±•ç¨‹åºã€‚ktx æ‰©å±•ç¨‹åºå¯ä»¥ä¸º Jetpackã€Android å¹³å°åŠå…¶ä»– API æä¾›ç®€æ´çš„æƒ¯ç”¨ Kotlin ä»£ç ï¼Œè¿™äº›æ‰©å±•ç¨‹åºåˆ©ç”¨äº†å¤šç§ Kotlin è¯­è¨€åŠŸèƒ½ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†å¯¹ Kotlin åç¨‹çš„æ”¯æŒ</p><h2 id="_1ã€lifecycle-ktx" tabindex="-1"><a class="header-anchor" href="#_1ã€lifecycle-ktx" aria-hidden="true">#</a> 1ã€Lifecycle ktx</h2><p>Lifecycle ktx ä¸ºæ¯ä¸ª Lifecycle å¯¹è±¡ï¼ˆActivityã€Fragmentã€Process ç­‰ï¼‰å®šä¹‰äº†ä¸€ä¸ª LifecycleScopeï¼Œè¯¥ä½œç”¨åŸŸå…·æœ‰ç”Ÿå‘½å‘¨æœŸå®‰å…¨çš„ä¿éšœï¼Œåœ¨æ­¤èŒƒå›´å†…å¯åŠ¨çš„åç¨‹ä¼šåœ¨ Lifecycle è¢«é”€æ¯æ—¶åŒæ—¶å–æ¶ˆï¼Œå¯ä»¥ä½¿ç”¨ <code>lifecycle.coroutineScope</code> æˆ– <code>lifecycleOwner.lifecycleScope</code> å±æ€§æ¥æ‹¿åˆ°è¯¥ CoroutineScope</p><p>å¼•å…¥ä¾èµ–</p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    implementation <span class="token interpolation-string"><span class="token string">&quot;androidx.lifecycle:lifecycle-runtime-ktx:2.4.0&quot;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ç¤ºä¾‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">class</span> MyActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        lifecycleScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token comment">//Do Something</span>
        <span class="token punctuation">}</span>
        lifecycle<span class="token punctuation">.</span>coroutineScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token comment">//Do Something</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>lifecycleScope</code> å’Œ <code>lifecycle.coroutineScope</code> ä¸¤è€…æ˜¯ç­‰ä»·çš„ï¼Œ<code>lifecycleScope</code>åªæ˜¯ ktx åº“æä¾›çš„ä¸€ç§ç®€ä¾¿å†™æ³•ã€‚ä»æºç ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒlifecycleScope æ˜¯å­˜å‚¨åœ¨æŠ½è±¡ç±» Lifecycle çš„ <code>mInternalScopeRef</code>å­—æ®µä¸­ï¼Œä¸”ä½¿ç”¨çš„æ˜¯ SupervisorJob å’Œ <code>Dispatchers.Main.immediate</code>ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒä»»æ„å­åç¨‹çš„å¼‚å¸¸æƒ…å†µä¼šå½±å“åˆ°å…¨å±€çš„åç¨‹ä»»åŠ¡ï¼Œä¸”å…¶é»˜è®¤å°±æ˜¯åœ¨ä¸»çº¿ç¨‹è¿è¡Œåç¨‹</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">val</span> LifecycleOwner<span class="token punctuation">.</span>lifecycleScope<span class="token operator">:</span> LifecycleCoroutineScope
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> lifecycle<span class="token punctuation">.</span>coroutineScope

<span class="token keyword">public</span> <span class="token keyword">val</span> Lifecycle<span class="token punctuation">.</span>coroutineScope<span class="token operator">:</span> LifecycleCoroutineScope
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> existing <span class="token operator">=</span> mInternalScopeRef<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> LifecycleCoroutineScopeImpl<span class="token operator">?</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>existing <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> existing
            <span class="token punctuation">}</span>
            <span class="token keyword">val</span> newScope <span class="token operator">=</span> <span class="token function">LifecycleCoroutineScopeImpl</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                <span class="token function">SupervisorJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Dispatchers<span class="token punctuation">.</span>Main<span class="token punctuation">.</span>immediate
            <span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mInternalScopeRef<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> newScope<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                newScope<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> newScope
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2ã€viewmodel-ktx" tabindex="-1"><a class="header-anchor" href="#_2ã€viewmodel-ktx" aria-hidden="true">#</a> 2ã€ViewModel ktx</h2><p>ViewModel ktx åº“æä¾›äº†ä¸€ä¸ª viewModelScopeï¼Œç”¨äºåœ¨ ViewModel ä¸­å¯åŠ¨åç¨‹ï¼Œè¯¥ä½œç”¨åŸŸçš„ç”Ÿå‘½å‘¨æœŸå’Œ ViewModel ç›¸ç­‰ï¼Œå½“ ViewModel å›è°ƒäº† <code>onCleared()</code>æ–¹æ³•æ—¶ä¼šè‡ªåŠ¨å–æ¶ˆè¯¥ä½œç”¨åŸŸ</p><p>å¼•å…¥ä¾èµ–</p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    implementation <span class="token interpolation-string"><span class="token string">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.4.0&quot;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ <code>fetchDocs()</code> æ–¹æ³•å†…å°±ä¾é  <code>viewModelScope</code> å¯åŠ¨äº†ä¸€ä¸ªåç¨‹ï¼Œç”¨äºåœ¨åå°çº¿ç¨‹å‘èµ·ç½‘ç»œè¯·æ±‚</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">class</span> MyViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">fun</span> <span class="token function">fetchDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        viewModelScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> result <span class="token operator">=</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;https://developer.android.com&quot;</span></span><span class="token punctuation">)</span>
            <span class="token function">show</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">withContext</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æºç å¯ä»¥çœ‹åˆ°å…¶å¤§ä½“å®ç°æ€è·¯å’Œ<code>lifecycleScope</code> ç±»ä¼¼ï¼Œå­˜å‚¨åœ¨ ViewModel ç±»çš„ <code>mBagOfTags</code> è¿™ä¸ª Map ä¸­ï¼Œä¸”ä½¿ç”¨çš„ä¹Ÿæ˜¯ SupervisorJob å’Œ <code>Dispatchers.Main.immediate</code></p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">val</span> ViewModel<span class="token punctuation">.</span>viewModelScope<span class="token operator">:</span> CoroutineScope
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> scope<span class="token operator">:</span> CoroutineScope<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span>JOB_KEY<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>scope <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> scope
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">setTagIfAbsent</span><span class="token punctuation">(</span>
            JOB_KEY<span class="token punctuation">,</span>
            <span class="token function">CloseableCoroutineScope</span><span class="token punctuation">(</span><span class="token function">SupervisorJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Dispatchers<span class="token punctuation">.</span>Main<span class="token punctuation">.</span>immediate<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token keyword">internal</span> <span class="token keyword">class</span> <span class="token function">CloseableCoroutineScope</span><span class="token punctuation">(</span>context<span class="token operator">:</span> CoroutineContext<span class="token punctuation">)</span> <span class="token operator">:</span> Closeable<span class="token punctuation">,</span> CoroutineScope <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">val</span> coroutineContext<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> context

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        coroutineContext<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3ã€livedata-ktx" tabindex="-1"><a class="header-anchor" href="#_3ã€livedata-ktx" aria-hidden="true">#</a> 3ã€LiveData ktx</h2><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®Œæˆç‰¹å®šçš„å¼‚æ­¥è®¡ç®—ä»»åŠ¡ï¼Œæ ¹æ®è®¡ç®—ç»“æœæ¥å‘ LiveData å›è°ƒå€¼ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ LiveData ktx æä¾›çš„ <code>liveData</code> æ„å»ºå™¨å‡½æ•°æ¥æ‰§è¡Œ suspend å‡½æ•°æ‰€ä»£è¡¨çš„å¼‚æ­¥è®¡ç®—ä»»åŠ¡ï¼ˆè€—æ—¶ä»»åŠ¡ï¼‰ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™ LiveData</p><p>å¼•å…¥ä¾èµ–</p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    implementation <span class="token interpolation-string"><span class="token string">&quot;androidx.lifecycle:lifecycle-livedata-ktx:2.4.0&quot;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ<code>loadUser()</code> æ˜¯åœ¨å…¶å®ƒåœ°æ–¹å£°æ˜çš„ suspend å‡½æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>liveData</code> æ„å»ºå™¨å‡½æ•°å¼‚æ­¥è°ƒç”¨ <code>loadUser()</code>ï¼Œç„¶åä½¿ç”¨ <code>emit()</code> æ¥å‘å‡ºç»“æœï¼š</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> user<span class="token operator">:</span> LiveData<span class="token operator">&lt;</span>User<span class="token operator">&gt;</span> <span class="token operator">=</span> liveData <span class="token punctuation">{</span>
    <span class="token keyword">val</span> <span class="token keyword">data</span> <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æºç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰€ä¼ å…¥çš„ suspend ä»»åŠ¡ä½“ block æœ€ç»ˆæ˜¯ä¼šè¢« CoroutineLiveData åŒ…è£…ä¸ºä¸€ä¸ª BlockRunner å¯¹è±¡ï¼Œè€Œ CoroutineLiveData ä¼šåœ¨è‡ªèº«å¼€å§‹æœ‰ Observer ç›‘å¬æ—¶æ‰§è¡Œ blockRunnerï¼Œå¹¶åœ¨æ‰€æœ‰ Observer å‡è¢«ç§»é™¤æ—¶è‡ªåŠ¨ Cancel æ‰ blockRunner</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">liveData</span><span class="token punctuation">(</span>
    context<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> EmptyCoroutineContext<span class="token punctuation">,</span>
    timeoutInMs<span class="token operator">:</span> Long <span class="token operator">=</span> DEFAULT_TIMEOUT<span class="token punctuation">,</span>
    <span class="token annotation builtin">@BuilderInference</span> block<span class="token operator">:</span> <span class="token keyword">suspend</span> LiveDataScope<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span><span class="token operator">:</span> LiveData<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">CoroutineLiveData</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> timeoutInMs<span class="token punctuation">,</span> block<span class="token punctuation">)</span>

<span class="token keyword">internal</span> <span class="token keyword">class</span> CoroutineLiveData<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    context<span class="token operator">:</span> CoroutineContext <span class="token operator">=</span> EmptyCoroutineContext<span class="token punctuation">,</span>
    timeoutInMs<span class="token operator">:</span> Long <span class="token operator">=</span> DEFAULT_TIMEOUT<span class="token punctuation">,</span>
    block<span class="token operator">:</span> Block<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token operator">:</span> MediatorLiveData<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> blockRunner<span class="token operator">:</span> BlockRunner<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">?</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> emittedSource<span class="token operator">:</span> EmittedSource<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token keyword">init</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> supervisorJob <span class="token operator">=</span> <span class="token function">SupervisorJob</span><span class="token punctuation">(</span>context<span class="token punctuation">[</span>Job<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> scope <span class="token operator">=</span> <span class="token function">CoroutineScope</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Main<span class="token punctuation">.</span>immediate <span class="token operator">+</span> context <span class="token operator">+</span> supervisorJob<span class="token punctuation">)</span>
        blockRunner <span class="token operator">=</span> <span class="token function">BlockRunner</span><span class="token punctuation">(</span>
            liveData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
            block <span class="token operator">=</span> block<span class="token punctuation">,</span>
            timeoutInMs <span class="token operator">=</span> timeoutInMs<span class="token punctuation">,</span>
            scope <span class="token operator">=</span> scope
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            blockRunner <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        blockRunner<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">maybeRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onInactive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onInactive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        blockRunner<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">internal</span> <span class="token keyword">class</span> BlockRunner<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> liveData<span class="token operator">:</span> CoroutineLiveData<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> block<span class="token operator">:</span> Block<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> timeoutInMs<span class="token operator">:</span> Long<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> scope<span class="token operator">:</span> CoroutineScope<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> onDone<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// currently running block job.</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> runningJob<span class="token operator">:</span> Job<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token comment">// cancelation job created in cancel.</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> cancellationJob<span class="token operator">:</span> Job<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token annotation builtin">@MainThread</span>
    <span class="token keyword">fun</span> <span class="token function">maybeRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cancellationJob<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        cancellationJob <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>runningJob <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        runningJob <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> liveDataScope <span class="token operator">=</span> <span class="token function">LiveDataScopeImpl</span><span class="token punctuation">(</span>liveData<span class="token punctuation">,</span> coroutineContext<span class="token punctuation">)</span>
            <span class="token function">block</span><span class="token punctuation">(</span>liveDataScope<span class="token punctuation">)</span>
            <span class="token function">onDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation builtin">@MainThread</span>
    <span class="token keyword">fun</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cancellationJob <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">error</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Cancel call cannot happen without a maybeRun&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        cancellationJob <span class="token operator">=</span> scope<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>Main<span class="token punctuation">.</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">delay</span><span class="token punctuation">(</span>timeoutInMs<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>liveData<span class="token punctuation">.</span><span class="token function">hasActiveObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                runningJob<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                runningJob <span class="token operator">=</span> <span class="token keyword">null</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="åä¸€ã€å‚è€ƒèµ„æ–™" tabindex="-1"><a class="header-anchor" href="#åä¸€ã€å‚è€ƒèµ„æ–™" aria-hidden="true">#</a> åä¸€ã€å‚è€ƒèµ„æ–™</h1><p>æœ¬æ–‡å‚è€ƒäº†ä»¥ä¸‹æ–‡ç« ä¸­çš„å¾ˆå¤šèµ„æ–™ï¼Œåœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢</p><ul><li>https://github.com/Kotlin/Kotlinx.coroutines/blob/master/coroutines-guide.md</li><li>https://developer.android.google.cn/kotlin/coroutines</li><li>https://juejin.cn/post/6844904118180380680</li><li>https://juejin.cn/post/6888259219008126983</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/hqqich/hqqich.github.io/edit/main/src/md/kotlin/ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Kotlin åç¨‹.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: hqqich1314@outlook.com">hqqich</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson" class="vp-link nav-link prev nav-link prev" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20Gson.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸€æ–‡å¿«é€Ÿå…¥é—¨ Gson</div></a><a aria-label="ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2" class="vp-link nav-link next nav-link next" href="/blog/dist/md/kotlin/%E4%B8%80%E6%96%87%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%20RxJava%202.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">ä¸€æ–‡å¿«é€Ÿå…¥é—¨ RxJava 2<span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">hqqich</div><div class="vp-copyright">Copyright Â© 2024 hqqich</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/dist/assets/app-51229bef.js" defer></script>
  </body>
</html>
